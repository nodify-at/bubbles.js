"use strict";!function(){function t(t,e){function i(i,r,n){var s,a={enableDrop:i.enableDrop,handleDrop:i.handleDrop,enableFlip:i.enableFlip,disableNavigationSingleNode:i.disableNavigationSingleNode,scaleFactor:i.scaleFactor,ready:function(t){},navigateTo:i.navigateTo,onClick:function(t){"function"==typeof i.nodeSelected&&i.nodeSelected(t),t.clickCount=t.clickCount?t.clickCount+1:1,t.detail}},o=$(".bubbletree").get(0);i.$watch("data",function(r,n){if(r!==n&&!s){var h=t.parse(i.data);s=e.build(h,o,a)}},!0)}return{restrict:"A",scope:{nodeSelected:"=",navigateTo:"=",data:"=",scaleFactor:"@",disableNavigationSingleNode:"@",enableDrop:"@",enableFlip:"@",handleDrop:"="},link:i}}var e=angular.module("tribefire.bubble",[]);e.directive("tribefireBubble",t),t.$inject=["DataParser","BubbleTreeFactory"]}(),function(){function t(){function t(t,e,i){var r={};return r.enableDrop=i.enableDrop,r.handleDrop=i.handleDrop,r.enableFlip=i.enableFlip,r.disableNavigationSingleNode=i.disableNavigationSingleNode,r.data=t,r.container=e,r.bubbleType="donut",r.scaleFactor=i.scaleFactor,r.ready=function(e,r){$(".amount").remove(),i.ready(t)},r.navigateTo=i.navigateTo,r.onClick=i.onClick,r.rootPath="./",new BubbleTree(r)}return{build:t}}var e=angular.module("tribefire.bubble");e.factory("BubbleTreeFactory",t)}(),!function(t){"function"==typeof define&&define.amd?define(["jquery"],function(e){return t(e)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("jquery")):t(window.jQuery)}(function(t){function e(t){void 0===t&&(t=window.navigator.userAgent),t=t.toLowerCase();var e=/(edge)\/([\w.]+)/.exec(t)||/(opr)[\/]([\w.]+)/.exec(t)||/(chrome)[ \/]([\w.]+)/.exec(t)||/(version)(applewebkit)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+).*(version)[ \/]([\w.]+).*(safari)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("trident")>=0&&/(rv)(?::| )([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[],i=/(ipad)/.exec(t)||/(ipod)/.exec(t)||/(iphone)/.exec(t)||/(kindle)/.exec(t)||/(silk)/.exec(t)||/(android)/.exec(t)||/(windows phone)/.exec(t)||/(win)/.exec(t)||/(mac)/.exec(t)||/(linux)/.exec(t)||/(cros)/.exec(t)||/(playbook)/.exec(t)||/(bb)/.exec(t)||/(blackberry)/.exec(t)||[],r={},n={browser:e[5]||e[3]||e[1]||"",version:e[2]||e[4]||"0",versionNumber:e[4]||e[2]||"0",platform:i[0]||""};if(n.browser&&(r[n.browser]=!0,r.version=n.version,r.versionNumber=parseInt(n.versionNumber,10)),n.platform&&(r[n.platform]=!0),(r.android||r.bb||r.blackberry||r.ipad||r.iphone||r.ipod||r.kindle||r.playbook||r.silk||r["windows phone"])&&(r.mobile=!0),(r.cros||r.mac||r.linux||r.win)&&(r.desktop=!0),(r.chrome||r.opr||r.safari)&&(r.webkit=!0),r.rv||r.edge){var s="msie";n.browser=s,r[s]=!0}if(r.safari&&r.blackberry){var a="blackberry";n.browser=a,r[a]=!0}if(r.safari&&r.playbook){var o="playbook";n.browser=o,r[o]=!0}if(r.bb){var h="blackberry";n.browser=h,r[h]=!0}if(r.opr){var l="opera";n.browser=l,r[l]=!0}if(r.safari&&r.android){var c="android";n.browser=c,r[c]=!0}if(r.safari&&r.kindle){var u="kindle";n.browser=u,r[u]=!0}if(r.safari&&r.silk){var f="silk";n.browser=f,r[f]=!0}return r.name=n.browser,r.platform=n.platform,r}return window.jQBrowser=e(window.navigator.userAgent),window.jQBrowser.uaMatch=e,t&&(t.browser=window.jQBrowser),window.jQBrowser}),function(t){function e(e){f.parent||(f.parent=t('<div id="'+e.id+'"><h3></h3><div class="body"></div><div class="url"></div></div>').appendTo(document.body).hide(),t.fn.bgiframe&&f.parent.bgiframe(),f.title=t("h3",f.parent),f.body=t("div.body",f.parent),f.url=t("div.url",f.parent))}function i(e){return t.data(e,"tooltip")}function r(e){i(this).delay?u=setTimeout(s,i(this).delay):s(),p=!!i(this).track,t(document.body).bind("mousemove",a),a(e)}function n(){if(!t.tooltip.blocked&&this!=l&&(this.tooltipText||i(this).bodyHandler)){if(l=this,c=this.tooltipText,i(this).bodyHandler){f.title.hide();var e=i(this).bodyHandler.call(this);e.nodeType||e.jquery?f.body.empty().append(e):f.body.html(e),f.body.show()}else if(i(this).showBody){var n=c.split(i(this).showBody);f.title.html(n.shift()).show(),f.body.empty();for(var s,a=0;s=n[a];a++)a>0&&f.body.append("<br/>"),f.body.append(s);f.body.hideWhenEmpty()}else f.title.html(c).show(),f.body.hide();i(this).showURL&&t(this).url()?f.url.html(t(this).url().replace("http://","")).show():f.url.hide(),f.parent.addClass(i(this).extraClass),i(this).fixPNG&&f.parent.fixPNG(),r.apply(this,arguments)}}function s(){u=null,d&&t.fn.bgiframe||!i(l).fade?f.parent.show():f.parent.is(":animated")?f.parent.stop().show().fadeTo(i(l).fade,l.tOpacity):f.parent.is(":visible")?f.parent.fadeTo(i(l).fade,l.tOpacity):f.parent.fadeIn(i(l).fade),a()}function a(e){if(!(t.tooltip.blocked||e&&"OPTION"==e.target.tagName)){if(!p&&f.parent.is(":visible")&&t(document.body).unbind("mousemove",a),null==l)return void t(document.body).unbind("mousemove",a);f.parent.removeClass("viewport-right").removeClass("viewport-bottom");var r=f.parent[0].offsetLeft,n=f.parent[0].offsetTop;if(e){r=e.pageX+i(l).left,n=e.pageY+i(l).top;var s="auto";i(l).positionLeft&&(s=t(window).width()-r,r="auto"),f.parent.css({left:r,right:s,top:n})}var h=o(),c=f.parent[0];h.x+h.cx<c.offsetLeft+c.offsetWidth&&(r-=c.offsetWidth+20+i(l).left,f.parent.css({left:r+"px"}).addClass("viewport-right")),h.y+h.cy<c.offsetTop+c.offsetHeight&&(n-=c.offsetHeight+20+i(l).top,f.parent.css({top:n+"px"}).addClass("viewport-bottom"))}}function o(){return{x:t(window).scrollLeft(),y:t(window).scrollTop(),cx:t(window).width(),cy:t(window).height()}}function h(e){function r(){f.parent.removeClass(n.extraClass).hide().css("opacity","")}if(!t.tooltip.blocked){u&&clearTimeout(u),l=null;var n=i(this);d&&t.fn.bgiframe||!n.fade?r():f.parent.is(":animated")?f.parent.stop().fadeTo(n.fade,0,r):f.parent.stop().fadeOut(n.fade,r),i(this).fixPNG&&f.parent.unfixPNG()}}var l,c,u,f={},d=t.browser.msie&&/MSIE\s(5\.5|6\.)/.test(navigator.userAgent),p=!1;t.tooltip={blocked:!1,defaults:{delay:200,fade:!1,showURL:!0,extraClass:"",top:15,left:15,id:"tooltip"},block:function(){t.tooltip.blocked=!t.tooltip.blocked}},t.fn.extend({tooltip:function(i){return i=t.extend({},t.tooltip.defaults,i),e(i),this.each(function(){t.data(this,"tooltip",i),this.tOpacity=f.parent.css("opacity"),this.tooltipText=this.title,t(this).removeAttr("title"),this.alt=""}).mouseover(n).mouseout(h).click(h)},fixPNG:d?function(){return this.each(function(){var e=t(this).css("backgroundImage");e.match(/^url\(["']?(.*\.png)["']?\)$/i)&&(e=RegExp.$1,t(this).css({backgroundImage:"none",filter:"progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, src='"+e+"')"}).each(function(){var e=t(this).css("position");"absolute"!=e&&"relative"!=e&&t(this).css("position","relative")}))})}:function(){return this},unfixPNG:d?function(){return this.each(function(){t(this).css({filter:"",backgroundImage:""})})}:function(){return this},hideWhenEmpty:function(){return this.each(function(){t(this)[t(this).html()?"show":"hide"]()})},url:function(){return this.attr("href")||this.attr("src")}})}(jQuery),function(t){function e(e){function r(t){return t===!0?function(t){return t}:"string"==typeof t&&(t=n(t.split("")))||"function"==typeof t?function(e){return t(encodeURIComponent(e))}:encodeURIComponent}function n(e){var i=new RegExp(t.map(e,encodeURIComponent).join("|"),"ig");return function(t){return t.replace(i,decodeURIComponent)}}e=t.extend({unescape:!1},e||{}),i.encoder=r(e.unescape)}var i={put:function(t,e){(e||window).location.hash=this.encoder(t)},get:function(e){var i=(e||window).location.hash.replace(/^#/,"");try{return t.browser.mozilla?i:decodeURIComponent(i)}catch(t){return i}},encoder:encodeURIComponent},r={id:"__jQuery_history",init:function(){var e='<iframe id="'+this.id+'" style="display:none" src="javascript:false;" />';return t("body").prepend(e),this},_document:function(){return t("#"+this.id)[0].contentWindow.document},put:function(t){var e=this._document();e.open(),e.close(),i.put(t,e)},get:function(){return i.get(this._document())}},n={};n.base={callback:void 0,type:void 0,check:function(){},load:function(t){},init:function(t,i){e(i),s.callback=t,s._options=i,s._init()},_init:function(){},_options:{}},n.timer={_appState:void 0,_init:function(){var t=i.get();s._appState=t,s.callback(t),setInterval(s.check,100)},check:function(){var t=i.get();t!=s._appState&&(s._appState=t,s.callback(t))},load:function(t){t!=s._appState&&(i.put(t),s._appState=t,s.callback(t))}},n.iframeTimer={_appState:void 0,_init:function(){var t=i.get();s._appState=t,r.init().put(t),s.callback(t),setInterval(s.check,100)},check:function(){var t=r.get(),e=i.get();e!=t&&(e==s._appState?(s._appState=t,i.put(t),s.callback(t)):(s._appState=e,r.put(e),s.callback(e)))},load:function(t){t!=s._appState&&(i.put(t),r.put(t),s._appState=t,s.callback(t))}},n.hashchangeEvent={_init:function(){s.callback(i.get()),t(window).bind("hashchange",s.check)},check:function(){s.callback(i.get())},load:function(t){i.put(t)}};var s=t.extend({},n.base);t.browser.msie&&(t.browser.version<8||document.documentMode<8)?s.type="iframeTimer":"onhashchange"in window?s.type="hashchangeEvent":s.type="timer",t.extend(s,n[s.type]),t.history=s}(jQuery),function(){function t(){if(t.is(arguments[0],j)){for(var e=arguments[0],i=Qt[m](t,e.splice(0,3+t.is(e[0],R))),r=i.set(),n=0,s=e[B];n<s;n++){var a=e[n]||{};l[f](a.type)&&r[G](i[a.type]().attr(a))}return r}return Qt[m](t,arguments)}function e(){for(var t=[],e=0;e<32;e++)t[e]=(~~(16*A.random()))[W](16);return t[12]=4,t[16]=(3&t[16]|8)[W](16),"r-"+t[M]("")}function i(t,e,i){function r(){var n=Array[u].slice.call(arguments,0),s=n[M]("►"),a=r.cache=r.cache||{},o=r.count=r.count||[];return a[f](s)?i?i(a[s]):a[s]:(o[B]>=1e3&&delete a[o.shift()],o[G](s),a[s]=t[m](e,n),i?i(a[s]):a[s])}return r}function r(e,i,r,n,s){return s?t.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",e+s,i,r-2*s,s,-s,n-2*s,2*s-r,2*s-n):t.format("M{0},{1}l{2},0,0,{3},{4},0z",e,i,r,n,-r)}function n(){return this.x+k+this.y}function s(e){return function(i,r,n,s){var a={back:e};return t.is(n,"function")?s=n:a.rot=n,i&&i.constructor==Gt&&(i=i.attrs.path),i&&(a.along=i),this.animate(a,r,s)}}function a(t,e,i,r,n,s){function a(t){return((u*t+c)*t+l)*t}function o(t,e){var i=h(t,e);return((p*i+d)*i+f)*i}function h(t,e){var i,r,n,s,o,h;for(n=t,h=0;h<8;h++){if(s=a(n)-t,O(s)<e)return n;if(o=(3*u*n+2*c)*n+l,O(o)<1e-6)break;n-=s/o}if(i=0,r=1,n=t,n<i)return i;if(n>r)return r;for(;i<r;){if(s=a(n),O(s-t)<e)return n;t>s?i=n:r=n,n=(r-i)/2+i}return n}var l=3*e,c=3*(r-e)-l,u=1-l-c,f=3*i,d=3*(n-i)-f,p=1-f-d;return o(t,1/(200*s))}t.version="1.5.2";var o,h=/[, ]+/,l={circle:1,rect:1,path:1,ellipse:1,text:1,image:1},c=/\{(\d+)\}/g,u="prototype",f="hasOwnProperty",d=document,p=window,b={was:Object[u][f].call(p,"Raphael"),is:p.Raphael},g=function(){this.customAttributes={}},v="appendChild",m="apply",y="concat",x="createTouch"in d,w="",k=" ",E=String,T="split",C="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[T](k),N={mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"},M="join",B="length",_=E[u].toLowerCase,A=Math,S=A.max,$=A.min,O=A.abs,P=A.pow,I=A.PI,R="number",L="string",j="array",W="toString",D="fill",H=Object[u][W],G="push",U=/^url\(['"]?([^\)]+?)['"]?\)$/i,F=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+%?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsba?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\)|hsla?\(\s*([\d\.]+(?:deg|\xb0|%)?\s*,\s*[\d\.]+%?\s*,\s*[\d\.]+(?:%?\s*,\s*[\d\.]+)?)%?\s*\))\s*$/i,z={NaN:1,Infinity:1,"-Infinity":1},q=/^(?:cubic-)?bezier\(([^,]+),([^,]+),([^,]+),([^\)]+)\)/,V=A.round,Y="setAttribute",X=parseFloat,Q=parseInt,Z=" progid:DXImageTransform.Microsoft",K=E[u].toUpperCase,J={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},tt={along:"along",blur:R,"clip-rect":"csv",cx:R,cy:R,fill:"colour","fill-opacity":R,"font-size":R,height:R,opacity:R,path:"path",r:R,rotation:"csv",rx:R,ry:R,scale:"csv",stroke:"colour","stroke-opacity":R,"stroke-width":R,translation:"csv",width:R,x:R,y:R},et="replace",it=/^(from|to|\d+%?)$/,rt=/\s*,\s*/,nt={hs:1,rg:1},st=/,?([achlmqrstvxz]),?/gi,at=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/gi,ot=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/gi,ht=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/,lt=function(t,e){return t.key-e.key};if(t.type=p.SVGAngle||d.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML","VML"==t.type){var ct,ut=d.createElement("div");if(ut.innerHTML='<v:shape adj="1"/>',ct=ut.firstChild,ct.style.behavior="url(#default#VML)",!ct||"object"!=typeof ct.adj)return t.type=null;ut=null}t.svg=!(t.vml="VML"==t.type),g[u]=t[u],o=g[u],t._id=0,t._oid=0,t.fn={},t.is=function(t,e){return e=_.call(e),"finite"==e?!z[f](+t):"null"==e&&null===t||e==typeof t||"object"==e&&t===Object(t)||"array"==e&&Array.isArray&&Array.isArray(t)||H.call(t).slice(8,-1).toLowerCase()==e},t.angle=function(e,i,r,n,s,a){if(null==s){var o=e-r,h=i-n;return o||h?(180*(o<0)+180*A.atan(-h/-o)/I+360)%360:0}return t.angle(e,i,s,a)-t.angle(r,n,s,a)},t.rad=function(t){return t%360*I/180},t.deg=function(t){return 180*t/I%360},t.snapTo=function(e,i,r){if(r=t.is(r,"finite")?r:10,t.is(e,j)){for(var n=e.length;n--;)if(O(e[n]-i)<=r)return e[n]}else{e=+e;var s=i%e;if(s<r)return i-s;if(s>e-r)return i-s+e}return i},t.setWindow=function(t){p=t,d=p.document};var ft=function(e){if(t.vml){var r,n=/^\s+|\s+$/g;try{var s=new ActiveXObject("htmlfile");s.write("<body>"),s.close(),r=s.body}catch(t){r=createPopup().document.body}var a=r.createTextRange();ft=i(function(t){try{r.style.color=E(t)[et](n,w);var e=a.queryCommandValue("ForeColor");return e=(255&e)<<16|65280&e|(16711680&e)>>>16,"#"+("000000"+e[W](16)).slice(-6)}catch(t){return"none"}})}else{var o=d.createElement("i");o.title="Raphaël Colour Picker",o.style.display="none",d.body[v](o),ft=i(function(t){return o.style.color=t,d.defaultView.getComputedStyle(o,w).getPropertyValue("color")})}return ft(e)},dt=function(){return"hsb("+[this.h,this.s,this.b]+")"},pt=function(){return"hsl("+[this.h,this.s,this.l]+")"},bt=function(){return this.hex};t.hsb2rgb=function(e,i,r,n){return t.is(e,"object")&&"h"in e&&"s"in e&&"b"in e&&(r=e.b,i=e.s,e=e.h,n=e.o),t.hsl2rgb(e,i,r/2,n)},t.hsl2rgb=function(e,i,r,n){t.is(e,"object")&&"h"in e&&"s"in e&&"l"in e&&(r=e.l,i=e.s,e=e.h),(e>1||i>1||r>1)&&(e/=360,i/=100,r/=100);var s,a,o,h={},l=["r","g","b"];if(i){s=r<.5?r*(1+i):r+i-r*i,a=2*r-s;for(var c=0;c<3;c++)o=e+1/3*-(c-1),o<0&&o++,o>1&&o--,6*o<1?h[l[c]]=a+6*(s-a)*o:2*o<1?h[l[c]]=s:3*o<2?h[l[c]]=a+(s-a)*(2/3-o)*6:h[l[c]]=a}else h={r:r,g:r,b:r};return h.r*=255,h.g*=255,h.b*=255,h.hex="#"+(16777216|h.b|h.g<<8|h.r<<16).toString(16).slice(1),t.is(n,"finite")&&(h.opacity=n),h.toString=bt,h},t.rgb2hsb=function(e,i,r){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,i=e.g,e=e.r),null==i&&t.is(e,L)){var n=t.getRGB(e);e=n.r,i=n.g,r=n.b}(e>1||i>1||r>1)&&(e/=255,i/=255,r/=255);var s,a,o=S(e,i,r),h=$(e,i,r),l=o;if(h==o)return{h:0,s:0,b:o,toString:dt};var c=o-h;return a=c/o,s=e==o?(i-r)/c:i==o?2+(r-e)/c:4+(e-i)/c,s/=6,s<0&&s++,s>1&&s--,{h:s,s:a,b:l,toString:dt}},t.rgb2hsl=function(e,i,r){if(null==i&&t.is(e,"object")&&"r"in e&&"g"in e&&"b"in e&&(r=e.b,i=e.g,e=e.r),null==i&&t.is(e,L)){var n=t.getRGB(e);e=n.r,i=n.g,r=n.b}(e>1||i>1||r>1)&&(e/=255,i/=255,r/=255);var s,a,o,h=S(e,i,r),l=$(e,i,r),c=(h+l)/2;if(l==h)o={h:0,s:0,l:c};else{var u=h-l;a=c<.5?u/(h+l):u/(2-h-l),s=e==h?(i-r)/u:i==h?2+(r-e)/u:4+(e-i)/u,s/=6,s<0&&s++,s>1&&s--,o={h:s,s:a,l:c}}return o.toString=pt,o},t._path2string=function(){return this.join(",")[et](st,"$1")},t.getRGB=i(function(e){if(!e||(e=E(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none"};!(nt[f](e.toLowerCase().substring(0,2))||"#"==e.charAt())&&(e=ft(e));var i,r,n,s,a,o,h=e.match(F);return h?(h[2]&&(n=Q(h[2].substring(5),16),r=Q(h[2].substring(3,5),16),i=Q(h[2].substring(1,3),16)),h[3]&&(n=Q((a=h[3].charAt(3))+a,16),r=Q((a=h[3].charAt(2))+a,16),i=Q((a=h[3].charAt(1))+a,16)),h[4]&&(o=h[4][T](rt),i=X(o[0]),"%"==o[0].slice(-1)&&(i*=2.55),r=X(o[1]),"%"==o[1].slice(-1)&&(r*=2.55),n=X(o[2]),"%"==o[2].slice(-1)&&(n*=2.55),"rgba"==h[1].toLowerCase().slice(0,4)&&(s=X(o[3])),o[3]&&"%"==o[3].slice(-1)&&(s/=100)),h[5]?(o=h[5][T](rt),i=X(o[0]),"%"==o[0].slice(-1)&&(i*=2.55),r=X(o[1]),"%"==o[1].slice(-1)&&(r*=2.55),n=X(o[2]),"%"==o[2].slice(-1)&&(n*=2.55),("deg"==o[0].slice(-3)||"°"==o[0].slice(-1))&&(i/=360),"hsba"==h[1].toLowerCase().slice(0,4)&&(s=X(o[3])),o[3]&&"%"==o[3].slice(-1)&&(s/=100),t.hsb2rgb(i,r,n,s)):h[6]?(o=h[6][T](rt),i=X(o[0]),"%"==o[0].slice(-1)&&(i*=2.55),r=X(o[1]),"%"==o[1].slice(-1)&&(r*=2.55),n=X(o[2]),"%"==o[2].slice(-1)&&(n*=2.55),("deg"==o[0].slice(-3)||"°"==o[0].slice(-1))&&(i/=360),"hsla"==h[1].toLowerCase().slice(0,4)&&(s=X(o[3])),o[3]&&"%"==o[3].slice(-1)&&(s/=100),t.hsl2rgb(i,r,n,s)):(h={r:i,g:r,b:n},h.hex="#"+(16777216|n|r<<8|i<<16).toString(16).slice(1),t.is(s,"finite")&&(h.opacity=s),h)):{r:-1,g:-1,b:-1,hex:"none",error:1}},t),t.getColor=function(t){var e=this.getColor.start=this.getColor.start||{h:0,s:1,b:t||.75},i=this.hsb2rgb(e.h,e.s,e.b);return e.h+=.075,e.h>1&&(e.h=0,e.s-=.2,e.s<=0&&(this.getColor.start={h:0,s:1,b:e.b})),i.hex},t.getColor.reset=function(){delete this.start},t.parsePathString=i(function(e){if(!e)return null;var i={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=[];return t.is(e,j)&&t.is(e[0],j)&&(r=vt(e)),r[B]||E(e)[et](at,function(t,e,n){var s=[],a=_.call(e);for(n[et](ot,function(t,e){e&&s[G](+e)}),"m"==a&&s[B]>2&&(r[G]([e][y](s.splice(0,2))),a="l",e="m"==e?"l":"L");s[B]>=i[a]&&(r[G]([e][y](s.splice(0,i[a]))),i[a]););}),r[W]=t._path2string,r}),t.findDotsAtSegment=function(t,e,i,r,n,s,a,o,h){var l=1-h,c=P(l,3)*t+3*P(l,2)*h*i+3*l*h*h*n+P(h,3)*a,u=P(l,3)*e+3*P(l,2)*h*r+3*l*h*h*s+P(h,3)*o,f=t+2*h*(i-t)+h*h*(n-2*i+t),d=e+2*h*(r-e)+h*h*(s-2*r+e),p=i+2*h*(n-i)+h*h*(a-2*n+i),b=r+2*h*(s-r)+h*h*(o-2*s+r),g=(1-h)*t+h*i,v=(1-h)*e+h*r,m=(1-h)*n+h*a,y=(1-h)*s+h*o,x=90-180*A.atan((f-p)/(d-b))/I;return(f>p||d<b)&&(x+=180),{x:c,y:u,m:{x:f,y:d},n:{x:p,y:b},start:{x:g,y:v},end:{x:m,y:y},alpha:x}};var gt=i(function(t){if(!t)return{x:0,y:0,width:0,height:0};t=Ct(t);for(var e,i=0,r=0,n=[],s=[],a=0,o=t[B];a<o;a++)if(e=t[a],"M"==e[0])i=e[1],r=e[2],n[G](i),s[G](r);else{var h=Tt(i,r,e[1],e[2],e[3],e[4],e[5],e[6]);n=n[y](h.min.x,h.max.x),s=s[y](h.min.y,h.max.y),i=e[5],r=e[6]}var l=$[m](0,n),c=$[m](0,s);return{x:l,y:c,width:S[m](0,n)-l,height:S[m](0,s)-c}}),vt=function(e){var i=[];t.is(e,j)&&t.is(e&&e[0],j)||(e=t.parsePathString(e));for(var r=0,n=e[B];r<n;r++){i[r]=[];for(var s=0,a=e[r][B];s<a;s++)i[r][s]=e[r][s]}return i[W]=t._path2string,i},mt=i(function(e){t.is(e,j)&&t.is(e&&e[0],j)||(e=t.parsePathString(e));var i=[],r=0,n=0,s=0,a=0,o=0;"M"==e[0][0]&&(r=e[0][1],n=e[0][2],s=r,a=n,o++,i[G](["M",r,n]));for(var h=o,l=e[B];h<l;h++){var c=i[h]=[],u=e[h];if(u[0]!=_.call(u[0]))switch(c[0]=_.call(u[0]),c[0]){case"a":c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=+(u[6]-r).toFixed(3),c[7]=+(u[7]-n).toFixed(3);break;case"v":c[1]=+(u[1]-n).toFixed(3);break;case"m":s=u[1],a=u[2];default:for(var f=1,d=u[B];f<d;f++)c[f]=+(u[f]-(f%2?r:n)).toFixed(3)}else{c=i[h]=[],"m"==u[0]&&(s=u[1]+r,a=u[2]+n);for(var p=0,b=u[B];p<b;p++)i[h][p]=u[p]}var g=i[h][B];switch(i[h][0]){case"z":r=s,n=a;break;case"h":r+=+i[h][g-1];break;case"v":n+=+i[h][g-1];break;default:r+=+i[h][g-2],n+=+i[h][g-1]}}return i[W]=t._path2string,i},0,vt),yt=i(function(e){t.is(e,j)&&t.is(e&&e[0],j)||(e=t.parsePathString(e));var i=[],r=0,n=0,s=0,a=0,o=0;"M"==e[0][0]&&(r=+e[0][1],n=+e[0][2],s=r,a=n,o++,i[0]=["M",r,n]);for(var h=o,l=e[B];h<l;h++){var c=i[h]=[],u=e[h];if(u[0]!=K.call(u[0]))switch(c[0]=K.call(u[0]),c[0]){case"A":c[1]=u[1],c[2]=u[2],c[3]=u[3],c[4]=u[4],c[5]=u[5],c[6]=+(u[6]+r),c[7]=+(u[7]+n);break;case"V":c[1]=+u[1]+n;break;case"H":c[1]=+u[1]+r;break;case"M":s=+u[1]+r,a=+u[2]+n;default:for(var f=1,d=u[B];f<d;f++)c[f]=+u[f]+(f%2?r:n)}else for(var p=0,b=u[B];p<b;p++)i[h][p]=u[p];switch(c[0]){case"Z":r=s,n=a;break;case"H":r=c[1];break;case"V":n=c[1];break;case"M":s=i[h][i[h][B]-2],a=i[h][i[h][B]-1];default:r=i[h][i[h][B]-2],n=i[h][i[h][B]-1]}}return i[W]=t._path2string,i},null,vt),xt=function(t,e,i,r){return[t,e,i,r,i,r]},wt=function(t,e,i,r,n,s){var a=1/3,o=2/3;return[a*t+o*i,a*e+o*r,a*n+o*i,a*s+o*r,n,s]},kt=function(t,e,r,n,s,a,o,h,l,c){var u,f=120*I/180,d=I/180*(+s||0),p=[],b=i(function(t,e,i){var r=t*A.cos(i)-e*A.sin(i),n=t*A.sin(i)+e*A.cos(i);return{x:r,y:n}});if(c)N=c[0],_=c[1],E=c[2],C=c[3];else{u=b(t,e,-d),t=u.x,e=u.y,u=b(h,l,-d),h=u.x,l=u.y;var g=(A.cos(I/180*s),A.sin(I/180*s),(t-h)/2),v=(e-l)/2,m=g*g/(r*r)+v*v/(n*n);m>1&&(m=A.sqrt(m),r=m*r,n=m*n);var x=r*r,w=n*n,k=(a==o?-1:1)*A.sqrt(O((x*w-x*v*v-w*g*g)/(x*v*v+w*g*g))),E=k*r*v/n+(t+h)/2,C=k*-n*g/r+(e+l)/2,N=A.asin(((e-C)/n).toFixed(9)),_=A.asin(((l-C)/n).toFixed(9));N=t<E?I-N:N,_=h<E?I-_:_,N<0&&(N=2*I+N),_<0&&(_=2*I+_),o&&N>_&&(N-=2*I),!o&&_>N&&(_-=2*I)}var S=_-N;if(O(S)>f){var $=_,P=h,R=l;_=N+f*(o&&_>N?1:-1),h=E+r*A.cos(_),l=C+n*A.sin(_),p=kt(h,l,r,n,s,0,o,P,R,[_,$,E,C])}S=_-N;var L=A.cos(N),j=A.sin(N),W=A.cos(_),D=A.sin(_),H=A.tan(S/4),G=4/3*r*H,U=4/3*n*H,F=[t,e],z=[t+G*j,e-U*L],q=[h+G*D,l-U*W],V=[h,l];if(z[0]=2*F[0]-z[0],z[1]=2*F[1]-z[1],c)return[z,q,V][y](p);p=[z,q,V][y](p)[M]()[T](",");for(var Y=[],X=0,Q=p[B];X<Q;X++)Y[X]=X%2?b(p[X-1],p[X],d).y:b(p[X],p[X+1],d).x;return Y},Et=function(t,e,i,r,n,s,a,o,h){var l=1-h;return{x:P(l,3)*t+3*P(l,2)*h*i+3*l*h*h*n+P(h,3)*a,y:P(l,3)*e+3*P(l,2)*h*r+3*l*h*h*s+P(h,3)*o}},Tt=i(function(t,e,i,r,n,s,a,o){var h,l=n-2*i+t-(a-2*n+i),c=2*(i-t)-2*(n-i),u=t-i,f=(-c+A.sqrt(c*c-4*l*u))/2/l,d=(-c-A.sqrt(c*c-4*l*u))/2/l,p=[e,o],b=[t,a];return O(f)>"1e12"&&(f=.5),O(d)>"1e12"&&(d=.5),f>0&&f<1&&(h=Et(t,e,i,r,n,s,a,o,f),b[G](h.x),p[G](h.y)),d>0&&d<1&&(h=Et(t,e,i,r,n,s,a,o,d),b[G](h.x),p[G](h.y)),l=s-2*r+e-(o-2*s+r),c=2*(r-e)-2*(s-r),u=e-r,f=(-c+A.sqrt(c*c-4*l*u))/2/l,d=(-c-A.sqrt(c*c-4*l*u))/2/l,O(f)>"1e12"&&(f=.5),O(d)>"1e12"&&(d=.5),f>0&&f<1&&(h=Et(t,e,i,r,n,s,a,o,f),b[G](h.x),p[G](h.y)),d>0&&d<1&&(h=Et(t,e,i,r,n,s,a,o,d),b[G](h.x),p[G](h.y)),{min:{x:$[m](0,b),y:$[m](0,p)},max:{x:S[m](0,b),y:S[m](0,p)}}}),Ct=i(function(t,e){for(var i=yt(t),r=e&&yt(e),n={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},s={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a=(function(t,e){var i,r;if(!t)return["C",e.x,e.y,e.x,e.y,e.x,e.y];switch(!(t[0]in{T:1,Q:1})&&(e.qx=e.qy=null),t[0]){case"M":e.X=t[1],e.Y=t[2];break;case"A":t=["C"][y](kt[m](0,[e.x,e.y][y](t.slice(1))));break;case"S":i=e.x+(e.x-(e.bx||e.x)),r=e.y+(e.y-(e.by||e.y)),t=["C",i,r][y](t.slice(1));break;case"T":e.qx=e.x+(e.x-(e.qx||e.x)),e.qy=e.y+(e.y-(e.qy||e.y)),t=["C"][y](wt(e.x,e.y,e.qx,e.qy,t[1],t[2]));break;case"Q":e.qx=t[1],e.qy=t[2],t=["C"][y](wt(e.x,e.y,t[1],t[2],t[3],t[4]));break;case"L":t=["C"][y](xt(e.x,e.y,t[1],t[2]));break;case"H":t=["C"][y](xt(e.x,e.y,t[1],e.y));break;case"V":t=["C"][y](xt(e.x,e.y,e.x,t[1]));break;case"Z":t=["C"][y](xt(e.x,e.y,e.X,e.Y))}return t}),o=function(t,e){if(t[e][B]>7){t[e].shift();for(var n=t[e];n[B];)t.splice(e++,0,["C"][y](n.splice(0,6)));t.splice(e,1),c=S(i[B],r&&r[B]||0)}},h=function(t,e,n,s,a){t&&e&&"M"==t[a][0]&&"M"!=e[a][0]&&(e.splice(a,0,["M",s.x,s.y]),n.bx=0,n.by=0,n.x=t[a][1],n.y=t[a][2],c=S(i[B],r&&r[B]||0))},l=0,c=S(i[B],r&&r[B]||0);l<c;l++){i[l]=a(i[l],n),o(i,l),r&&(r[l]=a(r[l],s)),r&&o(r,l),h(i,r,n,s,l),h(r,i,s,n,l);var u=i[l],f=r&&r[l],d=u[B],p=r&&f[B];n.x=u[d-2],n.y=u[d-1],n.bx=X(u[d-4])||n.x,n.by=X(u[d-3])||n.y,s.bx=r&&(X(f[p-4])||s.x),s.by=r&&(X(f[p-3])||s.y),s.x=r&&f[p-2],s.y=r&&f[p-1]}return r?[i,r]:i},null,vt),Nt=i(function(e){for(var i=[],r=0,n=e[B];r<n;r++){var s={},a=e[r].match(/^([^:]*):?([\d\.]*)/);if(s.color=t.getRGB(a[1]),s.color.error)return null;s.color=s.color.hex,a[2]&&(s.offset=a[2]+"%"),i[G](s)}for(r=1,n=i[B]-1;r<n;r++)if(!i[r].offset){for(var o=X(i[r-1].offset||0),h=0,l=r+1;l<n;l++)if(i[l].offset){h=i[l].offset;break}h||(h=100,l=n),h=X(h);for(var c=(h-o)/(l-r+1);r<l;r++)o+=c,i[r].offset=o+"%"}return i}),Mt=function(e,i,r,n){var s;return t.is(e,L)||t.is(e,"object")?(s=t.is(e,L)?d.getElementById(e):e,s.tagName?null==i?{container:s,width:s.style.pixelWidth||s.offsetWidth,height:s.style.pixelHeight||s.offsetHeight}:{container:s,width:i,height:r}:void 0):{container:1,x:e,y:i,width:r,height:n}},Bt=function(t,e){var i=this;for(var r in e)if(e[f](r)&&!(r in t))switch(typeof e[r]){case"function":!function(e){t[r]=t===i?e:function(){return e[m](i,arguments)}}(e[r]);break;case"object":t[r]=t[r]||{},Bt.call(this,t[r],e[r]);break;default:t[r]=e[r]}},_t=function(t,e){t==e.top&&(e.top=t.prev),t==e.bottom&&(e.bottom=t.next),t.next&&(t.next.prev=t.prev),t.prev&&(t.prev.next=t.next)},At=function(t,e){e.top!==t&&(_t(t,e),t.next=null,t.prev=e.top,e.top.next=t,e.top=t)},St=function(t,e){e.bottom!==t&&(_t(t,e),t.next=e.bottom,t.prev=null,e.bottom.prev=t,e.bottom=t)},$t=function(t,e,i){_t(t,i),e==i.top&&(i.top=t),e.next&&(e.next.prev=t),t.next=e.next,t.prev=e,e.next=t},Ot=function(t,e,i){_t(t,i),e==i.bottom&&(i.bottom=t),e.prev&&(e.prev.next=t),t.prev=e.prev,e.prev=t,t.next=e},Pt=function(t){return function(){throw new Error("Raphaël: you are calling to method “"+t+"” of removed object")}};if(t.pathToRelative=mt,t.svg){o.svgns="http://www.w3.org/2000/svg",o.xlink="http://www.w3.org/1999/xlink",V=function(t){return+t+.5*(~~t===t)};var It=function(t,e){if(!e)return t=d.createElementNS(o.svgns,t),t.style.webkitTapHighlightColor="rgba(0,0,0,0)",t;for(var i in e)e[f](i)&&t[Y](i,E(e[i]))};t[W]=function(){return"Your browser supports SVG.\nYou are running Raphaël "+this.version};var Rt=function(t,e){var i=It("path");e.canvas&&e.canvas[v](i);var r=new Gt(i,e);return r.type="path",Wt(r,{fill:"none",stroke:"#000",path:t}),r},Lt=function(t,i,r){var n="linear",s=.5,a=.5,o=t.style;if(i=E(i)[et](ht,function(t,e,i){if(n="radial",e&&i){s=X(e),a=X(i);var r=2*(a>.5)-1;P(s-.5,2)+P(a-.5,2)>.25&&(a=A.sqrt(.25-P(s-.5,2))*r+.5)&&.5!=a&&(a=a.toFixed(5)-1e-5*r)}return w}),i=i[T](/\s*\-\s*/),"linear"==n){var h=i.shift();if(h=-X(h),isNaN(h))return null;var l=[0,0,A.cos(h*I/180),A.sin(h*I/180)],c=1/(S(O(l[2]),O(l[3]))||1);l[2]*=c,l[3]*=c,l[2]<0&&(l[0]=-l[2],l[2]=0),l[3]<0&&(l[1]=-l[3],l[3]=0)}var u=Nt(i);if(!u)return null;var f=t.getAttribute(D);f=f.match(/^url\(#(.*)\)$/),f&&r.defs.removeChild(d.getElementById(f[1]));var p=It(n+"Gradient");p.id=e(),It(p,"radial"==n?{fx:s,fy:a}:{x1:l[0],y1:l[1],x2:l[2],y2:l[3]}),r.defs[v](p);for(var b=0,g=u[B];b<g;b++){var m=It("stop");It(m,{offset:u[b].offset?u[b].offset:b?"100%":"0%","stop-color":u[b].color||"#fff"}),p[v](m)}return It(t,{fill:"url(#"+p.id+")",opacity:1,"fill-opacity":1}),o.fill=w,o.opacity=1,o.fillOpacity=1,1},jt=function(e){var i=e.getBBox();It(e.pattern,{patternTransform:t.format("translate({0},{1})",i.x,i.y)})},Wt=function(i,r){var n={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},s=i.node,a=i.attrs,o=i.rotate(),l=function(t,e){if(e=n[_.call(e)]){for(var i=t.attrs["stroke-width"]||"1",a={round:i,square:i,butt:0}[t.attrs["stroke-linecap"]||r["stroke-linecap"]]||0,o=[],h=e[B];h--;)o[h]=e[h]*i+(h%2?1:-1)*a;It(s,{"stroke-dasharray":o[M](",")})}};r[f]("rotation")&&(o=r.rotation);var c=E(o)[T](h);c.length-1?(c[1]=+c[1],c[2]=+c[2]):c=null,X(o)&&i.rotate(0,!0);for(var u in r)if(r[f](u)){if(!J[f](u))continue;var p=r[u];switch(a[u]=p,u){case"blur":i.blur(p);break;case"rotation":i.rotate(p,!0);break;case"href":case"title":case"target":var b=s.parentNode;if("a"!=_.call(b.tagName)){var g=It("a");b.insertBefore(g,s),g[v](s),b=g}"target"==u&&"blank"==p?b.setAttributeNS(i.paper.xlink,"show","new"):b.setAttributeNS(i.paper.xlink,u,p);break;case"cursor":s.style.cursor=p;break;case"clip-rect":var m=E(p)[T](h);if(4==m[B]){i.clip&&i.clip.parentNode.parentNode.removeChild(i.clip.parentNode);var y=It("clipPath"),x=It("rect");y.id=e(),It(x,{x:m[0],y:m[1],width:m[2],height:m[3]}),y[v](x),i.paper.defs[v](y),It(s,{"clip-path":"url(#"+y.id+")"}),i.clip=x}if(!p){var C=d.getElementById(s.getAttribute("clip-path")[et](/(^url\(#|\)$)/g,w));C&&C.parentNode.removeChild(C),It(s,{"clip-path":w}),delete i.clip}break;case"path":"path"==i.type&&It(s,{d:p?a.path=yt(p):"M0,0"});break;case"width":if(s[Y](u,p),!a.fx)break;u="x",p=a.x;case"x":a.fx&&(p=-a.x-(a.width||0));case"rx":if("rx"==u&&"rect"==i.type)break;case"cx":c&&("x"==u||"cx"==u)&&(c[1]+=p-a[u]),s[Y](u,p),i.pattern&&jt(i);break;case"height":if(s[Y](u,p),!a.fy)break;u="y",p=a.y;case"y":a.fy&&(p=-a.y-(a.height||0));case"ry":if("ry"==u&&"rect"==i.type)break;case"cy":c&&("y"==u||"cy"==u)&&(c[2]+=p-a[u]),s[Y](u,p),i.pattern&&jt(i);break;case"r":"rect"==i.type?It(s,{rx:p,ry:p}):s[Y](u,p);break;case"src":"image"==i.type&&s.setAttributeNS(i.paper.xlink,"href",p);break;case"stroke-width":s.style.strokeWidth=p,s[Y](u,p),a["stroke-dasharray"]&&l(i,a["stroke-dasharray"]);break;case"stroke-dasharray":l(i,p);break;case"translation":var N=E(p)[T](h);N[0]=+N[0]||0,N[1]=+N[1]||0,c&&(c[1]+=N[0],c[2]+=N[1]),Ne.call(i,N[0],N[1]);break;case"scale":N=E(p)[T](h),i.scale(+N[0]||1,+N[1]||+N[0]||1,isNaN(X(N[2]))?null:+N[2],isNaN(X(N[3]))?null:+N[3]);break;case D:var A=E(p).match(U);if(A){y=It("pattern");var S=It("image");y.id=e(),It(y,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1}),It(S,{x:0,y:0}),S.setAttributeNS(i.paper.xlink,"href",A[1]),y[v](S);var $=d.createElement("img");$.style.cssText="position:absolute;left:-9999em;top-9999em",$.onload=function(){It(y,{width:this.offsetWidth,height:this.offsetHeight}),It(S,{width:this.offsetWidth,height:this.offsetHeight}),d.body.removeChild(this),i.paper.safari()},d.body[v]($),$.src=A[1],i.paper.defs[v](y),s.style.fill="url(#"+y.id+")",It(s,{fill:"url(#"+y.id+")"}),i.pattern=y,i.pattern&&jt(i);break}var O=t.getRGB(p);if(O.error){if(({circle:1,ellipse:1}[f](i.type)||"r"!=E(p).charAt())&&Lt(s,p,i.paper)){a.gradient=p,a.fill="none";break}delete r.gradient,delete a.gradient,!t.is(a.opacity,"undefined")&&t.is(r.opacity,"undefined")&&It(s,{opacity:a.opacity}),!t.is(a["fill-opacity"],"undefined")&&t.is(r["fill-opacity"],"undefined")&&It(s,{"fill-opacity":a["fill-opacity"]})}O[f]("opacity")&&It(s,{"fill-opacity":O.opacity>1?O.opacity/100:O.opacity});case"stroke":O=t.getRGB(p),s[Y](u,O.hex),"stroke"==u&&O[f]("opacity")&&It(s,{"stroke-opacity":O.opacity>1?O.opacity/100:O.opacity});break;case"gradient":(({circle:1,ellipse:1})[f](i.type)||"r"!=E(p).charAt())&&Lt(s,p,i.paper);break;case"opacity":a.gradient&&!a[f]("stroke-opacity")&&It(s,{"stroke-opacity":p>1?p/100:p});case"fill-opacity":if(a.gradient){var P=d.getElementById(s.getAttribute(D)[et](/^url\(#|\)$/g,w));if(P){var I=P.getElementsByTagName("stop");I[I[B]-1][Y]("stop-opacity",p)}break}default:"font-size"==u&&(p=Q(p,10)+"px");var R=u[et](/(\-.)/g,function(t){return K.call(t.substring(1))});s.style[R]=p,s[Y](u,p)}}Ht(i,r),c?i.rotate(c.join(k)):X(o)&&i.rotate(o,!0)},Dt=1.2,Ht=function(e,i){if("text"==e.type&&(i[f]("text")||i[f]("font")||i[f]("font-size")||i[f]("x")||i[f]("y"))){var r=e.attrs,n=e.node,s=n.firstChild?Q(d.defaultView.getComputedStyle(n.firstChild,w).getPropertyValue("font-size"),10):10;if(i[f]("text")){for(r.text=i.text;n.firstChild;)n.removeChild(n.firstChild);
for(var a=E(i.text)[T]("\n"),o=0,h=a[B];o<h;o++)if(a[o]){var l=It("tspan");o&&It(l,{dy:s*Dt,x:r.x}),l[v](d.createTextNode(a[o])),n[v](l)}}else for(a=n.getElementsByTagName("tspan"),o=0,h=a[B];o<h;o++)o&&It(a[o],{dy:s*Dt,x:r.x});It(n,{y:r.y});var c=e.getBBox(),u=r.y-(c.y+c.height/2);u&&t.is(u,"finite")&&It(n,{y:r.y+u})}},Gt=function(e,i){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.paper=i,this.attrs=this.attrs||{},this.transformations=[],this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1},!i.bottom&&(i.bottom=this),this.prev=i.top,i.top&&(i.top.next=this),i.top=this,this.next=null},Ut=Gt[u];Gt[u].rotate=function(e,i,r){if(this.removed)return this;if(null==e)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][M](k):this._.rt.deg;var n=this.getBBox();return e=E(e)[T](h),e[B]-1&&(i=X(e[1]),r=X(e[2])),e=X(e[0]),null!=i&&i!==!1?this._.rt.deg=e:this._.rt.deg+=e,null==r&&(i=null),this._.rt.cx=i,this._.rt.cy=r,i=null==i?n.x+n.width/2:i,r=null==r?n.y+n.height/2:r,this._.rt.deg?(this.transformations[0]=t.format("rotate({0} {1} {2})",this._.rt.deg,i,r),this.clip&&It(this.clip,{transform:t.format("rotate({0} {1} {2})",-this._.rt.deg,i,r)})):(this.transformations[0]=w,this.clip&&It(this.clip,{transform:w})),It(this.node,{transform:this.transformations[M](k)}),this},Gt[u].hide=function(){return!this.removed&&(this.node.style.display="none"),this},Gt[u].show=function(){return!this.removed&&(this.node.style.display=""),this},Gt[u].remove=function(){if(!this.removed){_t(this,this.paper),this.node.parentNode.removeChild(this.node);for(var t in this)delete this[t];this.removed=!0}},Gt[u].getBBox=function(){if(this.removed)return this;if("path"==this.type)return gt(this.attrs.path);if("none"==this.node.style.display){this.show();var t=!0}var e={};try{e=this.node.getBBox()}catch(t){}finally{e=e||{}}if("text"==this.type){e={x:e.x,y:1/0,width:0,height:0};for(var i=0,r=this.node.getNumberOfChars();i<r;i++){var n=this.node.getExtentOfChar(i);n.y<e.y&&(e.y=n.y),n.y+n.height-e.y>e.height&&(e.height=n.y+n.height-e.y),n.x+n.width-e.x>e.width&&(e.width=n.x+n.width-e.x)}}return t&&this.hide(),e},Gt[u].attr=function(e,i){if(this.removed)return this;if(null==e){var r={};for(var n in this.attrs)this.attrs[f](n)&&(r[n]=this.attrs[n]);return this._.rt.deg&&(r.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(r.scale=this.scale()),r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r}if(null==i&&t.is(e,L))return"translation"==e?Ne.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==D&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(null==i&&t.is(e,j)){for(var s={},a=0,o=e.length;a<o;a++)s[e[a]]=this.attr(e[a]);return s}if(null!=i){var h={};h[e]=i}else null!=e&&t.is(e,"object")&&(h=e);for(var l in this.paper.customAttributes)if(this.paper.customAttributes[f](l)&&h[f](l)&&t.is(this.paper.customAttributes[l],"function")){var c=this.paper.customAttributes[l].apply(this,[][y](h[l]));this.attrs[l]=h[l];for(var u in c)c[f](u)&&(h[u]=c[u])}return Wt(this,h),this},Gt[u].toFront=function(){if(this.removed)return this;this.node.parentNode[v](this.node);var t=this.paper;return t.top!=this&&At(this,t),this},Gt[u].toBack=function(){if(this.removed)return this;if(this.node.parentNode.firstChild!=this.node){this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),St(this,this.paper);this.paper}return this},Gt[u].insertAfter=function(t){if(this.removed)return this;var e=t.node||t[t.length-1].node;return e.nextSibling?e.parentNode.insertBefore(this.node,e.nextSibling):e.parentNode[v](this.node),$t(this,t,this.paper),this},Gt[u].insertBefore=function(t){if(this.removed)return this;var e=t.node||t[0].node;return e.parentNode.insertBefore(this.node,e),Ot(this,t,this.paper),this},Gt[u].blur=function(t){var i=this;if(0!==+t){var r=It("filter"),n=It("feGaussianBlur");i.attrs.blur=t,r.id=e(),It(n,{stdDeviation:+t||1.5}),r.appendChild(n),i.paper.defs.appendChild(r),i._blur=r,It(i.node,{filter:"url(#"+r.id+")"})}else i._blur&&(i._blur.parentNode.removeChild(i._blur),delete i._blur,delete i.attrs.blur),i.node.removeAttribute("filter")};var Ft=function(t,e,i,r){var n=It("circle");t.canvas&&t.canvas[v](n);var s=new Gt(n,t);return s.attrs={cx:e,cy:i,r:r,fill:"none",stroke:"#000"},s.type="circle",It(n,s.attrs),s},zt=function(t,e,i,r,n,s){var a=It("rect");t.canvas&&t.canvas[v](a);var o=new Gt(a,t);return o.attrs={x:e,y:i,width:r,height:n,r:s||0,rx:s||0,ry:s||0,fill:"none",stroke:"#000"},o.type="rect",It(a,o.attrs),o},qt=function(t,e,i,r,n){var s=It("ellipse");t.canvas&&t.canvas[v](s);var a=new Gt(s,t);return a.attrs={cx:e,cy:i,rx:r,ry:n,fill:"none",stroke:"#000"},a.type="ellipse",It(s,a.attrs),a},Vt=function(t,e,i,r,n,s){var a=It("image");It(a,{x:i,y:r,width:n,height:s,preserveAspectRatio:"none"}),a.setAttributeNS(t.xlink,"href",e),t.canvas&&t.canvas[v](a);var o=new Gt(a,t);return o.attrs={x:i,y:r,width:n,height:s,src:e},o.type="image",o},Yt=function(t,e,i,r){var n=It("text");It(n,{x:e,y:i,"text-anchor":"middle"}),t.canvas&&t.canvas[v](n);var s=new Gt(n,t);return s.attrs={x:e,y:i,"text-anchor":"middle",text:r,font:J.font,stroke:"none",fill:"#000"},s.type="text",Wt(s,s.attrs),s},Xt=function(t,e){return this.width=t||this.width,this.height=e||this.height,this.canvas[Y]("width",this.width),this.canvas[Y]("height",this.height),this},Qt=function(){var e=Mt[m](0,arguments),i=e&&e.container,r=e.x,n=e.y,s=e.width,a=e.height;if(!i)throw new Error("SVG container not found.");var o=It("svg");return r=r||0,n=n||0,s=s||512,a=a||342,It(o,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:s,height:a}),1==i?(o.style.cssText="position:absolute;left:"+r+"px;top:"+n+"px",d.body[v](o)):i.firstChild?i.insertBefore(o,i.firstChild):i[v](o),i=new g,i.width=s,i.height=a,i.canvas=o,Bt.call(i,i,t.fn),i.clear(),i};o.clear=function(){for(var t=this.canvas;t.firstChild;)t.removeChild(t.firstChild);this.bottom=this.top=null,(this.desc=It("desc"))[v](d.createTextNode("Created with Raphaël")),t[v](this.desc),t[v](this.defs=It("defs"))},o.remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Pt(t)}}if(t.vml){var Zt={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Kt=/([clmz]),?([^clmz]*)/gi,Jt=/ progid:\S+Blur\([^\)]+\)/g,te=/-?[^,\s-]+/g,ee=1e3+k+1e3,ie=10,re={path:1,rect:1},ne=function(t){var e=/[ahqstv]/gi,i=yt;if(E(t).match(e)&&(i=Ct),e=/[clmz]/g,i==yt&&!E(t).match(e)){var r=E(t)[et](Kt,function(t,e,i){var r=[],n="m"==_.call(e),s=Zt[e];return i[et](te,function(t){n&&2==r[B]&&(s+=r+Zt["m"==e?"l":"L"],r=[]),r[G](V(t*ie))}),s+r});return r}var n,s,a=i(t);r=[];for(var o=0,h=a[B];o<h;o++){n=a[o],s=_.call(a[o][0]),"z"==s&&(s="x");for(var l=1,c=n[B];l<c;l++)s+=V(n[l]*ie)+(l!=c-1?",":w);r[G](s)}return r[M](k)};t[W]=function(){return"Your browser doesn’t support SVG. Falling down to VML.\nYou are running Raphaël "+this.version},Rt=function(t,e){var i=se("group");i.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",i.coordsize=e.coordsize,i.coordorigin=e.coordorigin;var r=se("shape"),n=r.style;n.width=e.width+"px",n.height=e.height+"px",r.coordsize=ee,r.coordorigin=e.coordorigin,i[v](r);var s=new Gt(r,i,e),a={fill:"none",stroke:"#000"};return t&&(a.path=t),s.type="path",s.path=[],s.Path=w,Wt(s,a),e.canvas[v](i),s},Wt=function(e,i){e.attrs=e.attrs||{};var n,s=e.node,a=e.attrs,o=s.style,l=(i.x!=a.x||i.y!=a.y||i.width!=a.width||i.height!=a.height||i.r!=a.r)&&"rect"==e.type,c=e;for(var u in i)i[f](u)&&(a[u]=i[u]);if(l&&(a.path=r(a.x,a.y,a.width,a.height,a.r),e.X=a.x,e.Y=a.y,e.W=a.width,e.H=a.height),i.href&&(s.href=i.href),i.title&&(s.title=i.title),i.target&&(s.target=i.target),i.cursor&&(o.cursor=i.cursor),"blur"in i&&e.blur(i.blur),(i.path&&"path"==e.type||l)&&(s.path=ne(a.path)),null!=i.rotation&&e.rotate(i.rotation,!0),i.translation&&(n=E(i.translation)[T](h),Ne.call(e,n[0],n[1]),null!=e._.rt.cx&&(e._.rt.cx+=+n[0],e._.rt.cy+=+n[1],e.setBox(e.attrs,n[0],n[1]))),i.scale&&(n=E(i.scale)[T](h),e.scale(+n[0]||1,+n[1]||+n[0]||1,+n[2]||null,+n[3]||null)),"clip-rect"in i){var p=E(i["clip-rect"])[T](h);if(4==p[B]){p[2]=+p[2]+ +p[0],p[3]=+p[3]+ +p[1];var b=s.clipRect||d.createElement("div"),g=b.style,m=s.parentNode;g.clip=t.format("rect({1}px {2}px {3}px {0}px)",p),s.clipRect||(g.position="absolute",g.top=0,g.left=0,g.width=e.paper.width+"px",g.height=e.paper.height+"px",m.parentNode.insertBefore(b,m),b[v](m),s.clipRect=b)}i["clip-rect"]||s.clipRect&&(s.clipRect.style.clip=w)}if("image"==e.type&&i.src&&(s.src=i.src),"image"==e.type&&i.opacity&&(s.filterOpacity=Z+".Alpha(opacity="+100*i.opacity+")",o.filter=(s.filterMatrix||w)+(s.filterOpacity||w)),i.font&&(o.font=i.font),i["font-family"]&&(o.fontFamily='"'+i["font-family"][T](",")[0][et](/^['"]+|['"]+$/g,w)+'"'),i["font-size"]&&(o.fontSize=i["font-size"]),i["font-weight"]&&(o.fontWeight=i["font-weight"]),i["font-style"]&&(o.fontStyle=i["font-style"]),null!=i.opacity||null!=i["stroke-width"]||null!=i.fill||null!=i.stroke||null!=i["stroke-width"]||null!=i["stroke-opacity"]||null!=i["fill-opacity"]||null!=i["stroke-dasharray"]||null!=i["stroke-miterlimit"]||null!=i["stroke-linejoin"]||null!=i["stroke-linecap"]){s=e.shape||s;var y=s.getElementsByTagName(D)&&s.getElementsByTagName(D)[0],x=!1;if(!y&&(x=y=se(D)),"fill-opacity"in i||"opacity"in i){var k=((+a["fill-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+t.getRGB(i.fill).o+1||2)-1);k=$(S(k,0),1),y.opacity=k}if(i.fill&&(y.on=!0),null!=y.on&&"none"!=i.fill||(y.on=!1),y.on&&i.fill){var C=i.fill.match(U);C?(y.src=C[1],y.type="tile"):(y.color=t.getRGB(i.fill).hex,y.src=w,y.type="solid",t.getRGB(i.fill).error&&(c.type in{circle:1,ellipse:1}||"r"!=E(i.fill).charAt())&&Lt(c,i.fill)&&(a.fill="none",a.gradient=i.fill))}x&&s[v](y);var N=s.getElementsByTagName("stroke")&&s.getElementsByTagName("stroke")[0],M=!1;!N&&(M=N=se("stroke")),(i.stroke&&"none"!=i.stroke||i["stroke-width"]||null!=i["stroke-opacity"]||i["stroke-dasharray"]||i["stroke-miterlimit"]||i["stroke-linejoin"]||i["stroke-linecap"])&&(N.on=!0),("none"==i.stroke||null==N.on||0==i.stroke||0==i["stroke-width"])&&(N.on=!1);var _=t.getRGB(i.stroke);N.on&&i.stroke&&(N.color=_.hex),k=((+a["stroke-opacity"]+1||2)-1)*((+a.opacity+1||2)-1)*((+_.o+1||2)-1);var A=.75*(X(i["stroke-width"])||1);if(k=$(S(k,0),1),null==i["stroke-width"]&&(A=a["stroke-width"]),i["stroke-width"]&&(N.weight=A),A&&A<1&&(k*=A)&&(N.weight=1),N.opacity=k,i["stroke-linejoin"]&&(N.joinstyle=i["stroke-linejoin"]||"miter"),N.miterlimit=i["stroke-miterlimit"]||8,i["stroke-linecap"]&&(N.endcap="butt"==i["stroke-linecap"]?"flat":"square"==i["stroke-linecap"]?"square":"round"),i["stroke-dasharray"]){var O={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"};N.dashstyle=O[f](i["stroke-dasharray"])?O[i["stroke-dasharray"]]:w}M&&s[v](N)}if("text"==c.type)switch(o=c.paper.span.style,a.font&&(o.font=a.font),a["font-family"]&&(o.fontFamily=a["font-family"]),a["font-size"]&&(o.fontSize=a["font-size"]),a["font-weight"]&&(o.fontWeight=a["font-weight"]),a["font-style"]&&(o.fontStyle=a["font-style"]),c.node.string&&(c.paper.span.innerHTML=E(c.node.string)[et](/</g,"&#60;")[et](/&/g,"&#38;")[et](/\n/g,"<br>")),c.W=a.w=c.paper.span.offsetWidth,c.H=a.h=c.paper.span.offsetHeight,c.X=a.x,c.Y=a.y+V(c.H/2),a["text-anchor"]){case"start":c.node.style["v-text-align"]="left",c.bbx=V(c.W/2);break;case"end":c.node.style["v-text-align"]="right",c.bbx=-V(c.W/2);break;default:c.node.style["v-text-align"]="center"}},Lt=function(t,e){t.attrs=t.attrs||{};var i,r=(t.attrs,"linear"),n=".5 .5";if(t.attrs.gradient=e,e=E(e)[et](ht,function(t,e,i){return r="radial",e&&i&&(e=X(e),i=X(i),P(e-.5,2)+P(i-.5,2)>.25&&(i=A.sqrt(.25-P(e-.5,2))*(2*(i>.5)-1)+.5),n=e+k+i),w}),e=e[T](/\s*\-\s*/),"linear"==r){var s=e.shift();if(s=-X(s),isNaN(s))return null}var a=Nt(e);if(!a)return null;if(t=t.shape||t.node,i=t.getElementsByTagName(D)[0]||se(D),!i.parentNode&&t.appendChild(i),a[B]){i.on=!0,i.method="none",i.color=a[0].color,i.color2=a[a[B]-1].color;for(var o=[],h=0,l=a[B];h<l;h++)a[h].offset&&o[G](a[h].offset+k+a[h].color);i.colors&&(i.colors.value=o[B]?o[M]():"0% "+i.color),"radial"==r?(i.type="gradientradial",i.focus="100%",i.focussize=n,i.focusposition=n):(i.type="gradient",i.angle=(270-s)%360)}return 1},Gt=function(e,i,r){this[0]=e,this.id=t._oid++,this.node=e,e.raphael=this,this.X=0,this.Y=0,this.attrs={},this.Group=i,this.paper=r,this._={tx:0,ty:0,rt:{deg:0},sx:1,sy:1},!r.bottom&&(r.bottom=this),this.prev=r.top,r.top&&(r.top.next=this),r.top=this,this.next=null},Ut=Gt[u],Ut.rotate=function(t,e,i){return this.removed?this:null==t?this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][M](k):this._.rt.deg:(t=E(t)[T](h),t[B]-1&&(e=X(t[1]),i=X(t[2])),t=X(t[0]),null!=e?this._.rt.deg=t:this._.rt.deg+=t,null==i&&(e=null),this._.rt.cx=e,this._.rt.cy=i,this.setBox(this.attrs,e,i),this.Group.style.rotation=this._.rt.deg,this)},Ut.setBox=function(t,e,i){if(this.removed)return this;var r=this.Group.style,n=this.shape&&this.shape.style||this.node.style;t=t||{};for(var s in t)t[f](s)&&(this.attrs[s]=t[s]);e=e||this._.rt.cx,i=i||this._.rt.cy;var a,o,h,l,c=this.attrs;switch(this.type){case"circle":a=c.cx-c.r,o=c.cy-c.r,h=l=2*c.r;break;case"ellipse":a=c.cx-c.rx,o=c.cy-c.ry,h=2*c.rx,l=2*c.ry;break;case"image":a=+c.x,o=+c.y,h=c.width||0,l=c.height||0;break;case"text":this.textpath.v=["m",V(c.x),", ",V(c.y-2),"l",V(c.x)+1,", ",V(c.y-2)][M](w),a=c.x-V(this.W/2),o=c.y-this.H/2,h=this.W,l=this.H;break;case"rect":case"path":if(this.attrs.path){var u=gt(this.attrs.path);a=u.x,o=u.y,h=u.width,l=u.height}else a=0,o=0,h=this.paper.width,l=this.paper.height;break;default:a=0,o=0,h=this.paper.width,l=this.paper.height}e=null==e?a+h/2:e,i=null==i?o+l/2:i;var d,p=e-this.paper.width/2,b=i-this.paper.height/2;r.left!=(d=p+"px")&&(r.left=d),r.top!=(d=b+"px")&&(r.top=d),this.X=re[f](this.type)?-p:a,this.Y=re[f](this.type)?-b:o,this.W=h,this.H=l,re[f](this.type)?(n.left!=(d=-p*ie+"px")&&(n.left=d),n.top!=(d=-b*ie+"px")&&(n.top=d)):"text"==this.type?(n.left!=(d=-p+"px")&&(n.left=d),n.top!=(d=-b+"px")&&(n.top=d)):(r.width!=(d=this.paper.width+"px")&&(r.width=d),r.height!=(d=this.paper.height+"px")&&(r.height=d),n.left!=(d=a-p+"px")&&(n.left=d),n.top!=(d=o-b+"px")&&(n.top=d),n.width!=(d=h+"px")&&(n.width=d),n.height!=(d=l+"px")&&(n.height=d))},Ut.hide=function(){return!this.removed&&(this.Group.style.display="none"),this},Ut.show=function(){return!this.removed&&(this.Group.style.display="block"),this},Ut.getBBox=function(){return this.removed?this:re[f](this.type)?gt(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}},Ut.remove=function(){if(!this.removed){_t(this,this.paper),this.node.parentNode.removeChild(this.node),this.Group.parentNode.removeChild(this.Group),this.shape&&this.shape.parentNode.removeChild(this.shape);for(var t in this)delete this[t];this.removed=!0}},Ut.attr=function(e,i){if(this.removed)return this;if(null==e){var r={};for(var n in this.attrs)this.attrs[f](n)&&(r[n]=this.attrs[n]);return this._.rt.deg&&(r.rotation=this.rotate()),(1!=this._.sx||1!=this._.sy)&&(r.scale=this.scale()),r.gradient&&"none"==r.fill&&(r.fill=r.gradient)&&delete r.gradient,r}if(null==i&&t.is(e,"string"))return"translation"==e?Ne.call(this):"rotation"==e?this.rotate():"scale"==e?this.scale():e==D&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[e];if(this.attrs&&null==i&&t.is(e,j)){var s,a={};for(n=0,s=e[B];n<s;n++)a[e[n]]=this.attr(e[n]);return a}var o;if(null!=i&&(o={},o[e]=i),null==i&&t.is(e,"object")&&(o=e),o){for(var h in this.paper.customAttributes)if(this.paper.customAttributes[f](h)&&o[f](h)&&t.is(this.paper.customAttributes[h],"function")){var l=this.paper.customAttributes[h].apply(this,[][y](o[h]));this.attrs[h]=o[h];for(var c in l)l[f](c)&&(o[c]=l[c])}o.text&&"text"==this.type&&(this.node.string=o.text),Wt(this,o),o.gradient&&({circle:1,ellipse:1}[f](this.type)||"r"!=E(o.gradient).charAt())&&Lt(this,o.gradient),(!re[f](this.type)||this._.rt.deg)&&this.setBox(this.attrs)}return this},Ut.toFront=function(){return!this.removed&&this.Group.parentNode[v](this.Group),this.paper.top!=this&&At(this,this.paper),this},Ut.toBack=function(){return this.removed?this:(this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),St(this,this.paper)),this)},Ut.insertAfter=function(t){return this.removed?this:(t.constructor==Me&&(t=t[t.length-1]),t.Group.nextSibling?t.Group.parentNode.insertBefore(this.Group,t.Group.nextSibling):t.Group.parentNode[v](this.Group),$t(this,t,this.paper),this)},Ut.insertBefore=function(t){return this.removed?this:(t.constructor==Me&&(t=t[0]),t.Group.parentNode.insertBefore(this.Group,t.Group),Ot(this,t,this.paper),this)},Ut.blur=function(e){var i=this.node.runtimeStyle,r=i.filter;r=r.replace(Jt,w),0!==+e?(this.attrs.blur=e,i.filter=r+k+Z+".Blur(pixelradius="+(+e||1.5)+")",i.margin=t.format("-{0}px 0 0 -{0}px",V(+e||1.5))):(i.filter=r,i.margin=0,delete this.attrs.blur)},Ft=function(t,e,i,r){var n=se("group"),s=se("oval");s.style;n.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",n.coordsize=ee,n.coordorigin=t.coordorigin,n[v](s);var a=new Gt(s,n,t);return a.type="circle",Wt(a,{stroke:"#000",fill:"none"}),a.attrs.cx=e,a.attrs.cy=i,a.attrs.r=r,a.setBox({x:e-r,y:i-r,width:2*r,height:2*r}),t.canvas[v](n),a},zt=function(t,e,i,n,s,a){var o=r(e,i,n,s,a),h=t.path(o),l=h.attrs;return h.X=l.x=e,h.Y=l.y=i,h.W=l.width=n,h.H=l.height=s,l.r=a,l.path=o,h.type="rect",h},qt=function(t,e,i,r,n){var s=se("group"),a=se("oval");a.style;s.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",s.coordsize=ee,s.coordorigin=t.coordorigin,s[v](a);var o=new Gt(a,s,t);return o.type="ellipse",Wt(o,{stroke:"#000"}),o.attrs.cx=e,o.attrs.cy=i,o.attrs.rx=r,o.attrs.ry=n,o.setBox({x:e-r,y:i-n,width:2*r,height:2*n}),t.canvas[v](s),o},Vt=function(t,e,i,r,n,s){var a=se("group"),o=se("image");a.style.cssText="position:absolute;left:0;top:0;width:"+t.width+"px;height:"+t.height+"px",a.coordsize=ee,a.coordorigin=t.coordorigin,o.src=e,a[v](o);var h=new Gt(o,a,t);return h.type="image",h.attrs.src=e,h.attrs.x=i,h.attrs.y=r,h.attrs.w=n,h.attrs.h=s,h.setBox({x:i,y:r,width:n,height:s}),t.canvas[v](a),h},Yt=function(e,i,r,n){var s=se("group"),a=se("shape"),o=a.style,h=se("path"),l=(h.style,se("textpath"));s.style.cssText="position:absolute;left:0;top:0;width:"+e.width+"px;height:"+e.height+"px",s.coordsize=ee,s.coordorigin=e.coordorigin,h.v=t.format("m{0},{1}l{2},{1}",V(10*i),V(10*r),V(10*i)+1),h.textpathok=!0,o.width=e.width,o.height=e.height,l.string=E(n),l.on=!0,a[v](l),a[v](h),s[v](a);var c=new Gt(l,s,e);return c.shape=a,c.textpath=h,c.type="text",c.attrs.text=n,c.attrs.x=i,c.attrs.y=r,c.attrs.w=1,c.attrs.h=1,Wt(c,{font:J.font,stroke:"none",fill:"#000"}),c.setBox(),e.canvas[v](s),c},Xt=function(t,e){var i=this.canvas.style;return t==+t&&(t+="px"),e==+e&&(e+="px"),i.width=t,i.height=e,i.clip="rect(0 "+t+" "+e+" 0)",this};var se;d.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!d.namespaces.rvml&&d.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),se=function(t){return d.createElement("<rvml:"+t+' class="rvml">')}}catch(t){se=function(t){return d.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}Qt=function(){var e=Mt[m](0,arguments),i=e.container,r=e.height,n=e.width,s=e.x,a=e.y;if(!i)throw new Error("VML container not found.");var o=new g,h=o.canvas=d.createElement("div"),l=h.style;return s=s||0,a=a||0,n=n||512,r=r||342,n==+n&&(n+="px"),r==+r&&(r+="px"),o.width=1e3,o.height=1e3,o.coordsize=1e3*ie+k+1e3*ie,o.coordorigin="0 0",o.span=d.createElement("span"),o.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",h[v](o.span),l.cssText=t.format("top:0;left:0;width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",n,r),1==i?(d.body[v](h),l.left=s+"px",l.top=a+"px",l.position="absolute"):i.firstChild?i.insertBefore(h,i.firstChild):i[v](h),Bt.call(o,o,t.fn),o},o.clear=function(){this.canvas.innerHTML=w,this.span=d.createElement("span"),this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;",this.canvas[v](this.span),this.bottom=this.top=null},o.remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var t in this)this[t]=Pt(t);return!0}}var ae=navigator.userAgent.match(/Version\\x2f(.*?)\s/);"Apple Computer, Inc."==navigator.vendor&&(ae&&ae[1]<4||"iP"==navigator.platform.slice(0,2))?o.safari=function(){var t=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});p.setTimeout(function(){t.remove()})}:o.safari=function(){};for(var oe=function(){this.returnValue=!1},he=function(){return this.originalEvent.preventDefault()},le=function(){this.cancelBubble=!0},ce=function(){return this.originalEvent.stopPropagation()},ue=function(){return d.addEventListener?function(t,e,i,r){var n=x&&N[e]?N[e]:e,s=function(n){if(x&&N[f](e))for(var s=0,a=n.targetTouches&&n.targetTouches.length;s<a;s++)if(n.targetTouches[s].target==t){var o=n;n=n.targetTouches[s],n.originalEvent=o,n.preventDefault=he,n.stopPropagation=ce;break}return i.call(r,n)};return t.addEventListener(n,s,!1),function(){return t.removeEventListener(n,s,!1),!0}}:d.attachEvent?function(t,e,i,r){var n=function(t){return t=t||p.event,t.preventDefault=t.preventDefault||oe,t.stopPropagation=t.stopPropagation||le,i.call(r,t)};t.attachEvent("on"+e,n);var s=function(){return t.detachEvent("on"+e,n),!0};return s}:void 0}(),fe=[],de=function(t){for(var e,i=t.clientX,r=t.clientY,n=d.documentElement.scrollTop||d.body.scrollTop,s=d.documentElement.scrollLeft||d.body.scrollLeft,a=fe.length;a--;){if(e=fe[a],x){for(var o,h=t.touches.length;h--;)if(o=t.touches[h],o.identifier==e.el._drag.id){i=o.clientX,r=o.clientY,(t.originalEvent?t.originalEvent:t).preventDefault();break}}else t.preventDefault();i+=s,r+=n,e.move&&e.move.call(e.move_scope||e.el,i-e.el._drag.x,r-e.el._drag.y,i,r,t)}},pe=function(e){t.unmousemove(de).unmouseup(pe);for(var i,r=fe.length;r--;)i=fe[r],i.el._drag={},i.end&&i.end.call(i.end_scope||i.start_scope||i.move_scope||i.el,e);fe=[]},be=C[B];be--;)(function(e){t[e]=Gt[u][e]=function(i,r){return t.is(i,"function")&&(this.events=this.events||[],this.events.push({name:e,f:i,unbind:ue(this.shape||this.node||d,e,i,r||this)})),this},t["un"+e]=Gt[u]["un"+e]=function(t){for(var i=this.events,r=i[B];r--;)if(i[r].name==e&&i[r].f==t)return i[r].unbind(),i.splice(r,1),!i.length&&delete this.events,this;return this}})(C[be]);Ut.hover=function(t,e,i,r){return this.mouseover(t,i).mouseout(e,r||i)},Ut.unhover=function(t,e){return this.unmouseover(t).unmouseout(e)},Ut.drag=function(e,i,r,n,s,a){return this._drag={},this.mousedown(function(o){(o.originalEvent||o).preventDefault();var h=d.documentElement.scrollTop||d.body.scrollTop,l=d.documentElement.scrollLeft||d.body.scrollLeft;this._drag.x=o.clientX+l,this._drag.y=o.clientY+h,this._drag.id=o.identifier,i&&i.call(s||n||this,o.clientX+l,o.clientY+h,o),!fe.length&&t.mousemove(de).mouseup(pe),fe.push({el:this,move:e,end:r,move_scope:n,start_scope:s,end_scope:a})}),this},Ut.undrag=function(e,i,r){for(var n=fe.length;n--;)fe[n].el==this&&fe[n].move==e&&fe[n].end==r&&fe.splice(n++,1);!fe.length&&t.unmousemove(de).unmouseup(pe)},o.circle=function(t,e,i){return Ft(this,t||0,e||0,i||0)},o.rect=function(t,e,i,r,n){return zt(this,t||0,e||0,i||0,r||0,n||0)},o.ellipse=function(t,e,i,r){return qt(this,t||0,e||0,i||0,r||0)},o.path=function(e){return e&&!t.is(e,L)&&!t.is(e[0],j)&&(e+=w),Rt(t.format[m](t,arguments),this)},o.image=function(t,e,i,r,n){return Vt(this,t||"about:blank",e||0,i||0,r||0,n||0)},o.text=function(t,e,i){return Yt(this,t||0,e||0,E(i))},o.set=function(t){return arguments[B]>1&&(t=Array[u].splice.call(arguments,0,arguments[B])),new Me(t)},o.setSize=Xt,o.top=o.bottom=null,o.raphael=t,Ut.resetScale=function(){return this.removed?this:(this._.sx=1,this._.sy=1,void(this.attrs.scale="1 1"))},Ut.scale=function(t,e,i,r){if(this.removed)return this;if(null==t&&null==e)return{x:this._.sx,y:this._.sy,toString:n};e=e||t,!+e&&(e=t);var s,a,o=this.attrs;if(0!=t){var h=this.getBBox(),l=h.x+h.width/2,c=h.y+h.height/2,u=O(t/this._.sx),f=O(e/this._.sy);i=+i||0==i?i:l,r=+r||0==r?r:c;var d=this._.sx>0,p=this._.sy>0,b=~~(t/O(t)),g=~~(e/O(e)),v=u*b,m=f*g,x=this.node.style,E=i+O(l-i)*v*(l>i==d?1:-1),T=r+O(c-r)*m*(c>r==p?1:-1),C=t*b>e*g?f:u;switch(this.type){case"rect":case"image":var N=o.width*u,_=o.height*f;this.attr({height:_,r:o.r*C,width:N,x:E-N/2,y:T-_/2});break;case"circle":case"ellipse":this.attr({rx:o.rx*u,ry:o.ry*f,r:o.r*C,cx:E,cy:T});break;case"text":this.attr({x:E,y:T});break;case"path":for(var A=mt(o.path),S=!0,$=d?v:u,P=p?m:f,I=0,R=A[B];I<R;I++){var L=A[I],j=K.call(L[0]);if("M"!=j||!S)if(S=!1,"A"==j)L[A[I][B]-2]*=$,L[A[I][B]-1]*=P,L[1]*=u,L[2]*=f,L[5]=+(b+g?!!+L[5]:!+L[5]);else if("H"==j)for(var W=1,D=L[B];W<D;W++)L[W]*=$;else if("V"==j)for(W=1,D=L[B];W<D;W++)L[W]*=P;else for(W=1,D=L[B];W<D;W++)L[W]*=W%2?$:P}var H=gt(A);s=E-H.x-H.width/2,a=T-H.y-H.height/2,A[0][1]+=s,A[0][2]+=a,this.attr({path:A})}this.type in{text:1,image:1}&&(1!=b||1!=g)?this.transformations?(this.transformations[2]="scale("[y](b,",",g,")"),this.node[Y]("transform",this.transformations[M](k)),s=b==-1?-o.x-(N||0):o.x,a=g==-1?-o.y-(_||0):o.y,this.attr({x:s,y:a}),o.fx=b-1,o.fy=g-1):(this.node.filterMatrix=Z+".Matrix(M11="[y](b,", M12=0, M21=0, M22=",g,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),x.filter=(this.node.filterMatrix||w)+(this.node.filterOpacity||w)):this.transformations?(this.transformations[2]=w,this.node[Y]("transform",this.transformations[M](k)),o.fx=0,o.fy=0):(this.node.filterMatrix=w,x.filter=(this.node.filterMatrix||w)+(this.node.filterOpacity||w)),o.scale=[t,e,i,r][M](k),this._.sx=t,this._.sy=e}return this},Ut.clone=function(){if(this.removed)return null;var t=this.attr();return delete t.scale,delete t.translation,this.paper[this.type]().attr(t)};var ge={},ve=function(e,i,r,n,s,a,o,h,l){var c,u,f=0,d=100,p=[e,i,r,n,s,a,o,h].join(),b=ge[p];if(!b&&(ge[p]=b={data:[]}),b.timer&&clearTimeout(b.timer),b.timer=setTimeout(function(){delete ge[p]},2e3),null!=l){var g=ve(e,i,r,n,s,a,o,h);d=10*~~g}for(var v=0;v<d+1;v++){if(b.data[l]>v?u=b.data[v*d]:(u=t.findDotsAtSegment(e,i,r,n,s,a,o,h,v/d),b.data[v]=u),v&&(f+=P(P(c.x-u.x,2)+P(c.y-u.y,2),.5)),null!=l&&f>=l)return u;c=u}if(null==l)return f},me=function(e,i){return function(r,n,s){r=Ct(r);for(var a,o,h,l,c,u="",f={},d=0,p=0,b=r.length;p<b;p++){if(h=r[p],"M"==h[0])a=+h[1],o=+h[2];else{if(l=ve(a,o,h[1],h[2],h[3],h[4],h[5],h[6]),d+l>n){if(i&&!f.start){if(c=ve(a,o,h[1],h[2],h[3],h[4],h[5],h[6],n-d),u+=["C",c.start.x,c.start.y,c.m.x,c.m.y,c.x,c.y],s)return u;f.start=u,u=["M",c.x,c.y+"C",c.n.x,c.n.y,c.end.x,c.end.y,h[5],h[6]][M](),d+=l,a=+h[5],o=+h[6];continue}if(!e&&!i)return c=ve(a,o,h[1],h[2],h[3],h[4],h[5],h[6],n-d),{x:c.x,y:c.y,alpha:c.alpha}}d+=l,a=+h[5],o=+h[6]}u+=h}return f.end=u,c=e?d:i?f:t.findDotsAtSegment(a,o,h[1],h[2],h[3],h[4],h[5],h[6],1),c.alpha&&(c={x:c.x,y:c.y,alpha:c.alpha}),c}},ye=me(1),xe=me(),we=me(0,1);Ut.getTotalLength=function(){if("path"==this.type)return this.node.getTotalLength?this.node.getTotalLength():ye(this.attrs.path)},Ut.getPointAtLength=function(t){if("path"==this.type)return xe(this.attrs.path,t)},Ut.getSubpath=function(t,e){if("path"==this.type){if(O(this.getTotalLength()-e)<"1e-6")return we(this.attrs.path,t).end;var i=we(this.attrs.path,e,1);return t?we(i,t).end:i}},t.easing_formulas={linear:function(t){return t},"<":function(t){return P(t,3)},">":function(t){return P(t-1,3)+1},"<>":function(t){return t=2*t,t<1?P(t,3)/2:(t-=2,(P(t,3)+2)/2)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){t-=1;var e=1.70158;return t*t*((e+1)*t+e)+1},elastic:function(t){if(0==t||1==t)return t;var e=.3,i=e/4;return P(2,-10*t)*A.sin((t-i)*(2*I)/e)+1},bounce:function(t){var e,i=7.5625,r=2.75;return t<1/r?e=i*t*t:t<2/r?(t-=1.5/r,e=i*t*t+.75):t<2.5/r?(t-=2.25/r,e=i*t*t+.9375):(t-=2.625/r,e=i*t*t+.984375),e}};var ke=[],Ee=function(){for(var e=+new Date,i=0;i<ke[B];i++){var r=ke[i];if(!r.stop&&!r.el.removed){var n,s=e-r.start,a=r.ms,o=r.easing,h=r.from,l=r.diff,c=r.to,u=r.t,d=r.el,p={};if(s<a){var b=o(s/a);for(var g in h)if(h[f](g)){switch(tt[g]){case"along":n=b*a*l[g],c.back&&(n=c.len-n);var v=xe(c[g],n);d.translate(l.sx-l.x||0,l.sy-l.y||0),l.x=v.x,l.y=v.y,d.translate(v.x-l.sx,v.y-l.sy),c.rot&&d.rotate(l.r+v.alpha,v.x,v.y);break;case R:n=+h[g]+b*a*l[g];break;case"colour":n="rgb("+[Ce(V(h[g].r+b*a*l[g].r)),Ce(V(h[g].g+b*a*l[g].g)),Ce(V(h[g].b+b*a*l[g].b))][M](",")+")";break;case"path":n=[];for(var m=0,y=h[g][B];m<y;m++){n[m]=[h[g][m][0]];for(var x=1,E=h[g][m][B];x<E;x++)n[m][x]=+h[g][m][x]+b*a*l[g][m][x];n[m]=n[m][M](k)}n=n[M](k);break;case"csv":switch(g){case"translation":var T=b*a*l[g][0]-u.x,C=b*a*l[g][1]-u.y;u.x+=T,u.y+=C,n=T+k+C;break;case"rotation":n=+h[g][0]+b*a*l[g][0],h[g][1]&&(n+=","+h[g][1]+","+h[g][2]);break;case"scale":n=[+h[g][0]+b*a*l[g][0],+h[g][1]+b*a*l[g][1],2 in c[g]?c[g][2]:w,3 in c[g]?c[g][3]:w][M](k);break;case"clip-rect":for(n=[],m=4;m--;)n[m]=+h[g][m]+b*a*l[g][m]}break;default:var N=[].concat(h[g]);for(n=[],m=d.paper.customAttributes[g].length;m--;)n[m]=+N[m]+b*a*l[g][m]}p[g]=n}d.attr(p),d._run&&d._run.call(d)}else c.along&&(v=xe(c.along,c.len*!c.back),d.translate(l.sx-(l.x||0)+v.x-l.sx,l.sy-(l.y||0)+v.y-l.sy),c.rot&&d.rotate(l.r+v.alpha,v.x,v.y)),(u.x||u.y)&&d.translate(-u.x,-u.y),c.scale&&(c.scale+=w),d.attr(c),ke.splice(i--,1)}}t.svg&&d&&d.paper&&d.paper.safari(),ke[B]&&setTimeout(Ee)},Te=function(e,i,r,n,s){var a=r-n;i.timeouts.push(setTimeout(function(){t.is(s,"function")&&s.call(i),i.animate(e,a,e.easing)},n))},Ce=function(t){return S($(t,255),0)},Ne=function(t,e){if(null==t)return{x:this._.tx,y:this._.ty,toString:n};switch(this._.tx+=+t,this._.ty+=+e,this.type){case"circle":case"ellipse":this.attr({cx:+t+this.attrs.cx,cy:+e+this.attrs.cy});break;case"rect":case"image":case"text":this.attr({x:+t+this.attrs.x,y:+e+this.attrs.y});break;case"path":var i=mt(this.attrs.path);i[0][1]+=+t,i[0][2]+=+e,this.attr({path:i})}return this};Ut.animateWith=function(t,e,i,r,n){for(var s=0,a=ke.length;s<a;s++)ke[s].el.id==t.id&&(e.start=ke[s].start);return this.animate(e,i,r,n)},Ut.animateAlong=s(),Ut.animateAlongBack=s(1),Ut.onAnimation=function(t){return this._run=t||0,this},Ut.animate=function(e,i,r,n){var s=this;if(s.timeouts=s.timeouts||[],!t.is(r,"function")&&r||(n=r||null),s.removed)return n&&n.call(s),s;var o={},l={},c=!1,u={};for(var d in e)if(e[f](d)&&(tt[f](d)||s.paper.customAttributes[f](d)))switch(c=!0,o[d]=s.attr(d),null==o[d]&&(o[d]=J[d]),l[d]=e[d],tt[d]){case"along":var p=ye(e[d]),b=xe(e[d],p*!!e.back),g=s.getBBox();u[d]=p/i,u.tx=g.x,u.ty=g.y,u.sx=b.x,u.sy=b.y,l.rot=e.rot,l.back=e.back,l.len=p,e.rot&&(u.r=X(s.rotate())||0);break;case R:u[d]=(l[d]-o[d])/i;break;case"colour":o[d]=t.getRGB(o[d]);var v=t.getRGB(l[d]);u[d]={r:(v.r-o[d].r)/i,g:(v.g-o[d].g)/i,b:(v.b-o[d].b)/i};break;case"path":var m=Ct(o[d],l[d]);o[d]=m[0];var y=m[1];u[d]=[];for(var x=0,w=o[d][B];x<w;x++){u[d][x]=[0];for(var k=1,C=o[d][x][B];k<C;k++)u[d][x][k]=(y[x][k]-o[d][x][k])/i}break;case"csv":var N=E(e[d])[T](h),M=E(o[d])[T](h);switch(d){case"translation":o[d]=[0,0],u[d]=[N[0]/i,N[1]/i];break;case"rotation":o[d]=M[1]==N[1]&&M[2]==N[2]?M:[0,N[1],N[2]],u[d]=[(N[0]-o[d][0])/i,0,0];break;case"scale":e[d]=N,o[d]=E(o[d])[T](h),u[d]=[(N[0]-o[d][0])/i,(N[1]-o[d][1])/i,0,0];break;case"clip-rect":for(o[d]=E(o[d])[T](h),u[d]=[],x=4;x--;)u[d][x]=(N[x]-o[d][x])/i}l[d]=N;break;default:for(N=[].concat(e[d]),M=[].concat(o[d]),u[d]=[],x=s.paper.customAttributes[d][B];x--;)u[d][x]=((N[x]||0)-(M[x]||0))/i}if(c){var _=t.easing_formulas[r];
if(!_)if(_=E(r).match(q),_&&5==_[B]){var A=_;_=function(t){return a(t,+A[1],+A[2],+A[3],+A[4],i)}}else _=function(t){return t};ke.push({start:e.start||+new Date,ms:i,easing:_,from:o,diff:u,to:l,el:s,t:{x:0,y:0}}),t.is(n,"function")&&(s._ac=setTimeout(function(){n.call(s)},i)),1==ke[B]&&setTimeout(Ee)}else{var S,$=[];for(var O in e)e[f](O)&&it.test(O)&&(d={value:e[O]},"from"==O&&(O=0),"to"==O&&(O=100),d.key=Q(O,10),$.push(d));for($.sort(lt),$[0].key&&$.unshift({key:0,value:s.attrs}),x=0,w=$[B];x<w;x++)Te($[x].value,s,i/100*$[x].key,i/100*($[x-1]&&$[x-1].key||0),$[x-1]&&$[x-1].value.callback);S=$[$[B]-1].value.callback,S&&s.timeouts.push(setTimeout(function(){S.call(s)},i))}return this},Ut.stop=function(){for(var t=0;t<ke.length;t++)ke[t].el.id==this.id&&ke.splice(t--,1);for(t=0,ii=this.timeouts&&this.timeouts.length;t<ii;t++)clearTimeout(this.timeouts[t]);return this.timeouts=[],clearTimeout(this._ac),delete this._ac,this},Ut.translate=function(t,e){return this.attr({translation:t+" "+e})},Ut[W]=function(){return"Raphaël’s object"},t.ae=ke;var Me=function(t){if(this.items=[],this[B]=0,this.type="set",t)for(var e=0,i=t[B];e<i;e++)!t[e]||t[e].constructor!=Gt&&t[e].constructor!=Me||(this[this.items[B]]=this.items[this.items[B]]=t[e],this[B]++)};Me[u][G]=function(){for(var t,e,i=0,r=arguments[B];i<r;i++)t=arguments[i],!t||t.constructor!=Gt&&t.constructor!=Me||(e=this.items[B],this[e]=this.items[e]=t,this[B]++);return this},Me[u].pop=function(){return delete this[this[B]--],this.items.pop()};for(var Be in Ut)Ut[f](Be)&&(Me[u][Be]=function(t){return function(){for(var e=0,i=this.items[B];e<i;e++)this.items[e][t][m](this.items[e],arguments);return this}}(Be));Me[u].attr=function(e,i){if(e&&t.is(e,j)&&t.is(e[0],"object"))for(var r=0,n=e[B];r<n;r++)this.items[r].attr(e[r]);else for(var s=0,a=this.items[B];s<a;s++)this.items[s].attr(e,i);return this},Me[u].animate=function(e,i,r,n){(t.is(r,"function")||!r)&&(n=r||null);var s,a,o=this.items[B],h=o,l=this;for(n&&(a=function(){!--o&&n.call(l)}),r=t.is(r,L)?r:a,s=this.items[--h].animate(e,i,r,a);h--;)this.items[h]&&!this.items[h].removed&&this.items[h].animateWith(s,e,i,r,a);return this},Me[u].insertAfter=function(t){for(var e=this.items[B];e--;)this.items[e].insertAfter(t);return this},Me[u].getBBox=function(){for(var t=[],e=[],i=[],r=[],n=this.items[B];n--;){var s=this.items[n].getBBox();t[G](s.x),e[G](s.y),i[G](s.x+s.width),r[G](s.y+s.height)}return t=$[m](0,t),e=$[m](0,e),{x:t,y:e,width:S[m](0,i)-t,height:S[m](0,r)-e}},Me[u].clone=function(t){t=new Me;for(var e=0,i=this.items[B];e<i;e++)t[G](this.items[e].clone());return t},t.registerFont=function(t){if(!t.face)return t;this.fonts=this.fonts||{};var e={w:t.w,face:{},glyphs:{}},i=t.face["font-family"];for(var r in t.face)t.face[f](r)&&(e.face[r]=t.face[r]);if(this.fonts[i]?this.fonts[i][G](e):this.fonts[i]=[e],!t.svg){e.face["units-per-em"]=Q(t.face["units-per-em"],10);for(var n in t.glyphs)if(t.glyphs[f](n)){var s=t.glyphs[n];if(e.glyphs[n]={w:s.w,k:{},d:s.d&&"M"+s.d[et](/[mlcxtrv]/g,function(t){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[t]||"M"})+"z"},s.k)for(var a in s.k)s[f](a)&&(e.glyphs[n].k[a]=s.k[a])}}return t},o.getFont=function(e,i,r,n){if(n=n||"normal",r=r||"normal",i=+i||{normal:400,bold:700,lighter:300,bolder:800}[i]||400,t.fonts){var s=t.fonts[e];if(!s){var a=new RegExp("(^|\\s)"+e[et](/[^\w\d\s+!~.:_-]/g,w)+"(\\s|$)","i");for(var o in t.fonts)if(t.fonts[f](o)&&a.test(o)){s=t.fonts[o];break}}var h;if(s)for(var l=0,c=s[B];l<c&&(h=s[l],h.face["font-weight"]!=i||h.face["font-style"]!=r&&h.face["font-style"]||h.face["font-stretch"]!=n);l++);return h}},o.print=function(e,i,r,n,s,a,o){a=a||"middle",o=S($(o||0,1),-1);var l,c=this.set(),u=E(r)[T](w),f=0;if(t.is(n,r)&&(n=this.getFont(n)),n){l=(s||16)/n.face["units-per-em"];for(var d=n.face.bbox.split(h),p=+d[0],b=+d[1]+("baseline"==a?d[3]-d[1]+ +n.face.descent:(d[3]-d[1])/2),g=0,v=u[B];g<v;g++){var m=g&&n.glyphs[u[g-1]]||{},y=n.glyphs[u[g]];f+=g?(m.w||n.w)+(m.k&&m.k[u[g]]||0)+n.w*o:0,y&&y.d&&c[G](this.path(y.d).attr({fill:"#000",stroke:"none",translation:[f,0]}))}c.scale(l,l,p,b).translate(e-p,i-b)}return c},t.format=function(e,i){var r=t.is(i,j)?[0][y](i):arguments;return e&&t.is(e,L)&&r[B]-1&&(e=e[et](c,function(t,e){return null==r[++e]?w:r[e]})),e||w},t.ninja=function(){return b.was?p.Raphael=b.is:delete Raphael,t},t.el=Ut,t.st=Me[u],b.was?p.Raphael=t:Raphael=t}();var TWEEN=TWEEN||function(){var t,e,i,r,n=[];return{start:function(t){i=setInterval(this.update,1e3/(t||60))},stop:function(){clearInterval(i)},add:function(t){n.push(t)},remove:function(e){t=n.indexOf(e),t!==-1&&n.splice(t,1)},update:function(){for(t=0,e=n.length,r=(new Date).getTime();t<e;)n[t].update(r)?t++:(n.splice(t,1),e--)}}}();TWEEN.Tween=function(t){var e={},i={},r={},n=1e3,s=0,a=null,o=TWEEN.Easing.Linear.EaseNone,h=null,l=null,c=null;this.to=function(e,i){null!==i&&(n=i);for(var s in e)null!==t[s]&&(r[s]=e[s]);return this},this.start=function(){TWEEN.add(this),a=(new Date).getTime()+s;for(var n in r)null!==t[n]&&(e[n]=t[n],i[n]=r[n]-t[n]);return this},this.stop=function(){return TWEEN.remove(this),this},this.delay=function(t){return s=t,this},this.easing=function(t){return o=t,this},this.chain=function(t){h=t},this.onUpdate=function(t){return l=t,this},this.onComplete=function(t){return c=t,this},this.update=function(r){var s,u;if(r<a)return!0;r=(r-a)/n,r=r>1?1:r,u=o(r);for(s in i)t[s]=e[s]+i[s]*u;return null!==l&&l.call(t,u),1!=r||(null!==c&&c.call(t),null!==h&&h.start(),!1)}},TWEEN.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}},TWEEN.Easing.Linear.EaseNone=function(t){return t},TWEEN.Easing.Quadratic.EaseIn=function(t){return t*t},TWEEN.Easing.Quadratic.EaseOut=function(t){return-t*(t-2)},TWEEN.Easing.Quadratic.EaseInOut=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},TWEEN.Easing.Cubic.EaseIn=function(t){return t*t*t},TWEEN.Easing.Cubic.EaseOut=function(t){return--t*t*t+1},TWEEN.Easing.Cubic.EaseInOut=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},TWEEN.Easing.Quartic.EaseIn=function(t){return t*t*t*t},TWEEN.Easing.Quartic.EaseOut=function(t){return-(--t*t*t*t-1)},TWEEN.Easing.Quartic.EaseInOut=function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},TWEEN.Easing.Quintic.EaseIn=function(t){return t*t*t*t*t},TWEEN.Easing.Quintic.EaseOut=function(t){return(t-=1)*t*t*t*t+1},TWEEN.Easing.Quintic.EaseInOut=function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},TWEEN.Easing.Sinusoidal.EaseIn=function(t){return-Math.cos(t*Math.PI/2)+1},TWEEN.Easing.Sinusoidal.EaseOut=function(t){return Math.sin(t*Math.PI/2)},TWEEN.Easing.Sinusoidal.EaseInOut=function(t){return-.5*(Math.cos(Math.PI*t)-1)},TWEEN.Easing.Exponential.EaseIn=function(t){return 0==t?0:Math.pow(2,10*(t-1))},TWEEN.Easing.Exponential.EaseOut=function(t){return 1==t?1:-Math.pow(2,-10*t)+1},TWEEN.Easing.Exponential.EaseInOut=function(t){return 0==t?0:1==t?1:(t*=2)<1?.5*Math.pow(2,10*(t-1)):.5*(-Math.pow(2,-10*(t-1))+2)},TWEEN.Easing.Circular.EaseIn=function(t){return-(Math.sqrt(1-t*t)-1)},TWEEN.Easing.Circular.EaseOut=function(t){return Math.sqrt(1- --t*t)},TWEEN.Easing.Circular.EaseInOut=function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},TWEEN.Easing.Elastic.EaseIn=function(t){var e,i=.1,r=.4;return 0==t?0:1==t?1:(r||(r=.3),!i||i<1?(i=1,e=r/4):e=r/(2*Math.PI)*Math.asin(1/i),-(i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/r)))},TWEEN.Easing.Elastic.EaseOut=function(t){var e,i=.1,r=.4;return 0==t?0:1==t?1:(r||(r=.3),!i||i<1?(i=1,e=r/4):e=r/(2*Math.PI)*Math.asin(1/i),i*Math.pow(2,-10*t)*Math.sin(2*(t-e)*Math.PI/r)+1)},TWEEN.Easing.Elastic.EaseInOut=function(t){var e,i=.1,r=.4;return 0==t?0:1==t?1:(r||(r=.3),!i||i<1?(i=1,e=r/4):e=r/(2*Math.PI)*Math.asin(1/i),(t*=2)<1?-.5*i*Math.pow(2,10*(t-=1))*Math.sin(2*(t-e)*Math.PI/r):i*Math.pow(2,-10*(t-=1))*Math.sin(2*(t-e)*Math.PI/r)*.5+1)},TWEEN.Easing.Back.EaseIn=function(t){return t*t*(2.70158*t-1.70158)},TWEEN.Easing.Back.EaseOut=function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},TWEEN.Easing.Back.EaseInOut=function(t){return(t*=2)<1?.5*t*t*(3.5949095*t-2.5949095):.5*((t-=2)*t*(3.5949095*t+2.5949095)+2)},TWEEN.Easing.Bounce.EaseIn=function(t){return 1-TWEEN.Easing.Bounce.EaseOut(1-t)},TWEEN.Easing.Bounce.EaseOut=function(t){return(t/=1)<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},TWEEN.Easing.Bounce.EaseInOut=function(t){return t<.5?.5*TWEEN.Easing.Bounce.EaseIn(2*t):.5*TWEEN.Easing.Bounce.EaseOut(2*t-1)+.5};var vis4=function(){};vis4.log=function(){try{null!==window.console&&console.log.apply(this,arguments)}catch(t){}},vis4.str2time=function(t){var e=t.split(".");return Math.round(.001*Date.UTC(2e3+e[0],e[1]-1,e[2]))},vis4.round=function(t,e){var i=Math.pow(10,e);return Math.round(t*i)/i},vis4.formatNumber_ksep=".",vis4.formatNumber_dsep=",",vis4.formatNumber=function(t,e){t=""+t;for(var i="",r=0,n=t.length-1;n>=0;n--)r>0&&r<t.length&&r%3==0&&(i=vis4.formatNumber_ksep+i),i=t[n]+i,r++;return i},vis4.parseTSV=function(t,e){var i,r,n=t.split("\n"),s=[];for(r=0;r<n.length;r++){var a=n[r];if(""!==a)if(e)if(0===r)i=a.split("\t");else{var o={},h=a.split("\t");if(h.length!=i.length)return"wrong tsv format";for(var l=0;l<i.length;l++)o[$.trim(i[l])]=$.trim(h[l]);s.push(o)}else s.push(a.split("\t"))}return s},vis4.map=function(t,e){for(var i={},r=0;r<t.length;r++)i[t[r][e]]=t[r];return i},vis4.DelayedTask=function(){var t=this;t.init=function(t){var e=this,i=[];for(var r in t)r>2&&i.push(t[r]);e.func=t[2],e.scope=t[1],e.args=i,e.running=!0,e.timer=window.setTimeout(this.run.bind(e),t[0])},t.run=function(){var t=this;t.func.apply(t.scope,t.args),t.running=!1},t.cancel=function(){vis4.log("canceling timer",this),window.clearTimeout(this.timer),this.running=!1},t.init(arguments)};var vis4loadingItem=function(t,e,i,r){this.url=t,this.id=e,this.type=i,this.loader=r,this.load=function(){$.get(this.url,this.processContent.bind(this))},this.processContent=function(t){"tsv"==this.type?this.data=vis4.parseTSV(t,!0):"json"==this.type?this.data="string"==typeof t?$.parseJSON(t):t:this.data=t,this.loader.itemLoaded()}},vis4loader=function(){this.items=[],this.byID={},this.add=function(t,e,i){null===i&&(i="text");var r=new vis4loadingItem(t,e,i,this);this.items.push(r),this.byID[e]=r},this.load=function(t){this.callback=t,this.loaded=0;for(var e=0;e<this.items.length;e++)this.items[e].load()},this.itemLoaded=function(){this.loaded++,this.loaded==this.items.length&&this.callback(this)},this.get=function(t){return this.byID[t].data}},vis4color=function(t){this.h=0,this.s=.5,this.l=.8,this.v=1,this.i=1,this.r=255,this.g=0,this.b=0,this.x="#FF0000",this.u=0,this.br=1,this.K=1/180*Math.PI,"hsi"!=t&&"hsl"!=t&&"hsb"!=t&&"hsv"!=t||(this.mode=t),this.log=function(t){null!==window.console&&console.log(t)},this.cos=function(t){return Math.cos(t*this.K)},this.trim=function(t){return Math.max(0,Math.min(1,t))},this.setMode=function(t){"hsv"!=t&&"hsi"!=t&&"hsl"!=t&&"hsb"!=t&&this.log("unknown color mode "+t),this.mode=t,this.rgb2hsx()},this.setHexColor=function(t){"#"!=t.charAt(0)&&(t="#"+t),4==t.length&&(t="#"+t.charAt(1)+t.charAt(1)+t.charAt(2)+t.charAt(2)+t.charAt(3)+t.charAt(3)),7!=t.length&&this.log("invalid hex color"),this.x=t,this.hex2int(),this.int2rgb(),this.rgb2hsx()},this.setRGBColor=function(t,e,i){this.r=t,this.b=i,this.g=e,this.rgb2int(),this.int2hex(),this.rgb2hsx()},this.setHSVColor=function(t,e,i){"hsv"!=this.mode&&(this.mode="hsv"),this.h=t,this.s=this.trim(e),this.v=this.trim(i),this.hsv2rgb(),this.rgb2int(),this.int2hex()},this.setHSLColor=function(t,e,i){"hsl"!=this.mode&&(this.mode="hsl"),this.h=t,this.s=this.trim(e),this.l=this.trim(i),this.hsl2rgb(),this.rgb2int(),this.int2hex()},this.setHSBColor=function(t,e,i){"hsb"!=this.mode&&(this.mode="hsb"),this.h=t,this.s=this.trim(e),this.b=this.trim(i),this.hsb2rgb(),this.rgb2int(),this.int2hex()},this.setHSIColor=function(t,e,i){"hsi"!=this.mode&&(this.mode="hsi"),this.h=t,this.s=this.trim(e),this.i=this.trim(i),this.hsi2rgb(),this.rgb2int(),this.int2hex()},this.onChange=function(){},this.rgb2int=function(){this.u=this.r<<16|this.g<<8|this.b,this.onChange()},this.int2rgb=function(){this.r=this.u>>16,this.g=this.u>>8&255,this.b=255&this.u},this.hex2int=function(){this.u=parseInt(this.x.substr(1),16),this.onChange()},this.int2hex=function(){var t="000000"+this.u.toString(16).toUpperCase();this.x="#"+t.substr(t.length-6),this.onChange()},this.int2rgb=function(){this.r=this.u>>16,this.g=this.u>>8&255,this.b=255&this.u},this.hsx2rgb=function(){switch(this.mode){case"hsv":this.hsv2rgb();break;case"hsi":this.hsi2rgb();break;case"hsl":this.hsl2rgb();break;case"hsb":this.hsb2rgb()}},this.rgb2hsx=function(){switch(this.mode){case"hsv":this.rgb2hsv();break;case"hsi":this.rgb2hsi();break;case"hsl":this.rgb2hsl();break;case"hsb":this.rgb2hsb()}},this.hue=function(t){return this._evaluate(t,"h"),this.hsx2rgb(),this.rgb2int(),this.int2hex(),this},this.saturation=function(t){return this._evaluate(t,"s"),this.hsx2rgb(),this.rgb2int(),this.int2hex(),this},this.lightness=function(t){return"hsl"!=this.mode?void this.log("WARNING: lightness property not available in "+this.mode+" mode"):(this._evaluate(t,"l"),this.hsx2rgb(),this.rgb2int(),this.int2hex(),this)},this.brightness=function(t){return"hsb"!=this.mode?void this.log("WARNING: brightness property not available in "+this.mode+" mode"):(this._evaluate(t,"br"),this.hsx2rgb(),this.rgb2int(),this.int2hex(),this)},this.value=function(t){return"hsv"!=this.mode?void this.log("WARNING: value property not available in "+this.mode+" mode"):(this._evaluate(t,"v"),this.hsx2rgb(),this.rgb2int(),this.int2hex(),this)},this.intensity=function(t){return"hsi"!=this.mode?void this.log("WARNING: intensity property not available in "+this.mode+" mode"):(this._evaluate(t,"i"),this.hsx2rgb(),this.rgb2int(),this.int2hex(),this)},this._evaluate=function(t,e){"string"==typeof t?("+"!=t.charAt(0)||isNaN(t.substr(1))?"-"!=t.charAt(0)||isNaN(t.substr(1))||(this[e]=this[e]-Number(t.substr(1))):this[e]=Number(this[e])+Number(t.substr(1)),"*"!=t.charAt(0)||isNaN(t.substr(1))?"/"!=t.charAt(0)||isNaN(t.substr(1))||(this[e]=this[e]/Number(t.substr(1))):this[e]=this[e]*Number(t.substr(1))):isNaN(t)||(this[e]=Number(t))},this.rgb=function(){return[this.r,this.g,this.b]},this.hsl=function(){return[this.h,this.s,this.l]},this.rgb2hsv=function(){var t=Math.min(Math.min(this.r,this.g),this.b),e=Math.max(Math.max(this.r,this.g),this.b),i=e-t;this.v=e/255,this.s=i/e,0===this.s?this.h=void 0:(this.r==e&&(this.h=(this.g-this.b)/i),this.g==e&&(this.h=2+(this.b-this.r)/i),this.b==e&&(this.h=4+(this.r-this.g)/i),this.h*=60,this.h<0&&(this.h+=360))},this.hsv2rgb=function(){var t,e,i,r,n,s=this.h,a=this.s,o=this._rgb,h=255*this.v;if(0===this.s&&isNaN(s))this.r=this.g=this.b=h;else switch(360==s&&(s=0),s/=60,t=Math.floor(s),e=s-t,i=h*(1-a),r=h*(1-a*e),n=h*(1-a*(1-e)),t){case 0:o(h,n,i);break;case 1:o(r,h,i);break;case 2:o(i,h,n);break;case 3:o(i,r,h);break;case 4:o(n,i,h);break;case 5:o(h,i,r)}},this._rgb=function(t,e,i){this.r=t,this.g=e,this.b=i},this.rgb2hsl=function(){var t=this.r/255,e=this.g/255,i=this.b/255,r=Math.min(Math.min(t,e),i),n=Math.max(Math.max(t,e),i);this.l=(n+r)/2,n==r?(this.s=0,this.h=void 0):this.l<.5?this.s=(n-r)/(n+r):this.s=(n-r)/(2-n-r),t==n?this.h=(e-i)/(n-r):e==n?this.h=2+(i-t)/(n-r):i==n&&(this.h=4+(t-e)/(n-r)),this.h*=60,this.h<0&&(this.h+=360)},this.hsl2rgb=function(){if(0===this.s)this.r=this.g=this.b=255*this.l;else{var t,e,i=[0,0,0],r=[0,0,0];e=this.l<.5?this.l*(1+this.s):this.l+this.s-this.l*this.s,t=2*this.l-e;var n=this.h/360;i[0]=n+1/3,i[1]=n,i[2]=n-1/3;for(var s=0;s<3;s++)i[s]<0&&(i[s]+=1),i[s]>1&&(i[s]-=1),6*i[s]<1?r[s]=t+6*(e-t)*i[s]:2*i[s]<1?r[s]=e:3*i[s]<2?r[s]=t+(e-t)*(2/3-i[s])*6:r[s]=t;this.r=255*r[0],this.g=255*r[1],this.b=255*r[2]}},this.rgb2hsb=function(){this.rgb2hsl(),this.br=this._rgbLuminance()},this._rgbLuminance=function(){return(.2126*this.r+.7152*this.g+.0722*this.b)/255},this.hsb2rgb=function(){var t,e=.001,i=0,r=1,n=.5;this.l=n,this.hsl2rgb(),t=this._rgbLuminance();for(var s=0;Math.abs(t-this.br)>e&&s<100;)t>this.br?r=n:i=n,n=(i+r)/2,this.l=n,this.hsl2rgb(),t=this._rgbLuminance(),s++;this.br=t},this.rgb2hsi=function(){var t,e=this.r,i=this.g,r=this.b,n=(Math.max(Math.max(e,i),r),e+i+r);e/=n,i/=n,r/=n,t=Math.min(Math.min(e,i),r),this.i=(e+i+r)/765,this.h=this.acos((e-.5*i-.5*r)/Math.sqrt((e-i)*(e-i)+(e-r)*(i-r))),this.s=1-3*t,r>i&&(this.h=360-this.h)},this.hsi2rgb=function(){var t,e,i,r=this.h,n=this.i,s=this.s,a=this.cos;r<=120?(e=(1-s)/3,t=(1+s*a(r)/a(60-r))/3,i=1-(e+t)):r<=240?(r-=120,t=(1-s)/3,i=(1+s*a(r)/a(60-r))/3,e=1-(t+i)):(r-=240,i=(1-s)/3,e=(1+s*a(r)/a(60-r))/3,t=1-(i+e)),t=Math.min(255,t*n*3*255),i=Math.min(255,i*n*3*255),e=Math.min(255,e*n*3*255)}};vis4color.fromHex=function(t,e){null==e&&(e="hsl");var i=new vis4color(e);return i.setHexColor(t),i},vis4color.fromRGB=function(t,e,i,r){null===r&&(r="hsl");var n=new vis4color(r);return n.setRGBolor(t,e,i),n},vis4color.fromHSV=function(t,e,i,r){null===r&&(r="hsl");var n=new vis4color(r);return n.setHSVColor(t,e,i),n},vis4color.fromHSL=function(t,e,i,r){null===r&&(r="hsl");var n=new vis4color(r);return n.setHSLColor(t,e,i),n},vis4color.fromHSB=function(t,e,i,r){null===r&&(r="hsl");var n=new vis4color(r);return n.setHSBColor(t,e,i),n},vis4color.fromHSI=function(t,e,i,r){null===r&&(r="hsl");var n=new vis4color(r);return n.setHSIColor(t,e,i),n};var BubbleTree=function(t,e,i){var r=this;if(r.version="2.0.2",r.$container=$(t.container),r.config=$.extend({rootPath:"",minRadiusLabels:40,minRadiusAmounts:20,minRadiusHideLabels:0,cutLabelsAt:50},t),r.tooltip=t.tooltipCallback?t.tooltipCallback:function(){},t.tooltip&&(r.tooltip=t.tooltip),r.style=t.bubbleStyles,r.ns=BubbleTree,r.nodesByUrlToken={},r.nodeList=[],r.iconsByUrlToken={},r.globalNodeCounter=0,r.displayObjects=[],r.bubbleScale=1,r.globRotation=0,r.currentYear=t.initYear,r.currentCenter=void 0,r.currentTransition=void 0,r.baseUrl="",r.loadData=function(t){$.ajax({url:t,dataType:"json",success:this.setData.bind(this)})},r.setData=function(t){var e=this;t||(t=e.config.data),e.initData(t),e.initPaper(),e.initBubbles(),e.initTween(),e.initHistory(),e.postProcess(t)},r.postProcess=function(t){if(t){var e=this;angular.forEach(t.children,function(t){e.postProcess(t)})}},r.initData=function(t){var e=this;t.level=0,e.preprocessData(t),e.traverse(t,0),e.treeRoot=t},r.preprocessData=function(t){var e=this,i=e.config.maxNodesPerLevel;if(i&&i<t.children.length){var r=e.sortChildren(t.children);r.reverse();var n,s=[],a=[],o=0;for(var h in t.children)h<i?s.push(t.children[h]):(a.push(t.children[h]),o+=Math.max(0,t.children[h].amount));t.children=s,t.children.push({label:"More",name:"more",amount:o,children:a,breakdown:n})}},r.traverse=function(t,e){var i,r,n=this,s=n.config.bubbleStyles;if(t.children||(t.children=[]),n.nodeList.push(t),t.famount=n.ns.Utils.formatNumber(t.amount),t.parent&&(t.level=t.parent.level+1),n.config.clearColors===!0&&(t.color=!1),s){var a=["color","shortLabel","icon"];$.each(a,function(e,i){s.hasOwnProperty("id")&&s.id.hasOwnProperty(t.id)&&s.id[t.id].hasOwnProperty(i)?t[i]=s.id[t.id][i]:t.hasOwnProperty("name")&&s.hasOwnProperty("name")&&s.name.hasOwnProperty(t.name)&&s.name[t.name].hasOwnProperty(i)?t[i]=s.name[t.name][i]:t.hasOwnProperty("taxonomy")&&s.hasOwnProperty(t.taxonomy)&&s[t.taxonomy].hasOwnProperty(t.name)&&s[t.taxonomy][t.name].hasOwnProperty(i)&&(t[i]=s[t.taxonomy][t.name][i])})}for(t.color||(t.level>0?t.color=t.parent.color:t.color="#999999"),t.children.length<2&&t.color&&(t.color=vis4color.fromHex(t.color).saturation("*.86").x),t.level>0&&(i=t.parent.children,i.length>1&&(t.left=i[(e-1+i.length)%i.length],t.right=i[(Number(e)+1)%i.length],t.right==t.left&&(t.right=void 0))),r=void 0!==t.label&&""!==t.label?t.label:void 0!==t.token&&""!==t.token?t.token:""+n.globalNodeCounter,n.globalNodeCounter++,t.urlToken=r.toLowerCase().replace(/\W/g,"-");n.nodesByUrlToken.hasOwnProperty(t.urlToken);)t.urlToken+="-";n.nodesByUrlToken[t.urlToken]=t,t.maxChildAmount=0,t.children=n.sortChildren(t.children,!0,n.config.sortBy),$.each(t.children,function(e,i){i.parent=t,t.maxChildAmount=Math.max(t.maxChildAmount,i.amount),n.traverse(i,e)}),t.breakdowns&&(t.breakdownsByName={},$.each(t.breakdowns,function(e,i){i.famount=n.ns.Utils.formatNumber(i.amount),i.name&&(t.breakdownsByName[i.name]=i)}))},r.sortChildren=function(t,e,i){var n=[],s=!0;if("label"==i?(i=r.compareLabels,e=!1):i=r.compareAmounts,t.sort(i),e){for(;t.length>0;)n.push(s?t.pop():t.shift()),s=!s;return n}return t},r.compareAmounts=function(t,e){return t.amount>e.amount?1:t.amount==e.amount?0:-1},r.compareLabels=function(t,e){return t.label>e.label?1:t.label==e.label?0:-1},r.initPaper=function(){var t,e=this,i=e.$container,r=e.treeRoot,n=i.width(),s=i.height(),a=Raphael(i[0],n,s),o=.5*Math.min(n,s)-40,h=e.ns.Vector,l=new h(.5*n,.5*s);e.width=n,e.height=s,e.paper=a,t=Math.pow((Math.pow(r.amount,.6)+2*Math.pow(r.maxChildAmount,.6))/o,1.6666666667),e.a2radBase=e.ns.a2radBase=t,e.origin=l,$(window).resize(e.onResize.bind(e))},r.onResize=function(){var t,e=this,i=e.$container,r=i.width(),n=i.height(),s=.5*Math.min(r,n)-40,a=e.treeRoot;e.paper.setSize(r,n),e.origin.x=.5*r,e.origin.y=.5*n,e.width=r,e.height=n,t=Math.pow((Math.pow(a.amount,.6)+2*Math.pow(a.maxChildAmount,.6))/s,1.6666666667),e.a2radBase=e.ns.a2radBase=t,$.each(e.displayObjects,function(t,i){"bubble"==i.className&&(i.bubbleRad=e.ns.Utils.amount2rad(i.node.amount))}),e.currentCenter&&e.changeView(e.currentCenter.urlToken)},r.initTween=function(){this.tweenTimer=setInterval(this.loop,500/120)},r.initBubbles=function(){var t=this,e=t.treeRoot,i=!1;t.ns.Bubbles;t.bubbleClasses=[],t.config.hasOwnProperty("bubbleType")||(t.config.bubbleType=["plain"]),$.isArray(t.config.bubbleType)||(t.config.bubbleType=[t.config.bubbleType]),$.isArray(t.config.bubbleType)&&$.each(t.config.bubbleType,function(e){"icon"==t.config.bubbleType[e]&&(i=!0),t.bubbleClasses.push(t.getBubbleType(t.config.bubbleType[e]))});var r=t.createBubble(e,t.origin,0,0,e.color);t.traverseBubbles(r)},r.getBubbleType=function(t){var e=this,i=e.ns.Bubbles;return i.Donut},r.traverseBubbles=function(t){var e,i,r,n,s,a=this,o=a.ns.Utils.amount2rad,h=0,l=0,c=2*Math.PI;i=t.node.children,$.each(i,function(t,e){h+=o(e.amount)}),i.length>0&&(e=a.createRing(t.node,t.pos,0,{stroke:"#888","stroke-dasharray":"-"})),$.each(i,function(e,i){n=o(i.amount)/h*c,s=l+.5*n,isNaN(s)&&vis4.log(l,n,i.amount,h,c),i.centerAngle=s,r=a.createBubble(i,t.pos,0,s,i.color),l+=n,a.traverseBubbles(r)})},r.createBubble=function(t,e,i,r,n){var s,a=this,o=(a.ns,t.level);return isNaN(o)&&(o=0),o=Math.min(o,a.bubbleClasses.length-1),s=new a.bubbleClasses[o](t,a,e,i,r,n),a.displayObjects.push(s),s},r.createRing=function(t,e,i,r){var n,s=this,a=s.ns;return n=new a.Ring(t,s,e,i,r),s.displayObjects.push(n),n},r.changeView=function(t){var e,i,r,n=this,s=(n.paper,.35*Math.min(n.width,n.height)),a=n.ns,o=a.Utils,h=n.origin,l=o.amount2rad,c=n.treeRoot,u=n.nodesByUrlToken,f=u.hasOwnProperty(t)?u[t]:null,d=new a.Layout,p=2*Math.PI,b=n.getBubble.bind(n),g=n.getRing.bind(n),v=n.unifyAngle;if(null!==f){var m,y,x,w,k,E,T,C,N,M,B,_=!1,A=!1;for(r in n.displayObjects)n.displayObjects[r].hideFlag=!0;if(f==c||f.parent==c&&f.children.length<2){d.$(n).bubbleScale=n.config.scaleFactor?n.config.scaleFactor:1,d.$(h).x=.5*n.width,d.$(h).y=.5*n.height,m=b(c),f!=c&&(m.childRotation=-f.centerAngle),k=l(c.amount)+l(c.maxChildAmount)+40,N=g(c),d.$(N).rad=k;for(r in c.children)w=c.children[r],e=b(w),d.$(e).angle=v(w.centerAngle+m.childRotation),d.$(e).rad=k}else{var S=f;M=f.children.length<2?5:s/(l(f.amount)+1.5*l(f.maxChildAmount)),d.$(n).bubbleScale=M,m=b(f),n.currentCenter&&n.currentCenter==f.left?A=!0:n.currentCenter&&n.currentCenter==f.right&&(_=!0);var O=n.shortestAngleTo;_&&(O=n.shortestLeftTurn),A&&(O=n.shortestRightTurn),d.$(m).angle=O(m.angle,0),k=(l(f.amount)+l(f.maxChildAmount))*M+20,N=g(f),d.$(N).rad=k,y=b(f.parent),y.childRotation=-f.centerAngle;for(var P=y;P&&P.node.parent;)P=b(P.node.parent,!0),d.$(P).rad=0;d.$(y).rad=0;var I=.5*n.width;if(E=0-Math.max(.8*I-M*(l(f.parent.amount)+l(Math.max(1.15*f.amount+1.15*f.maxChildAmount,.85*f.left.amount,.85*f.right.amount))),M*l(f.parent.amount)*-1+.15*I)+I,f.left&&f.right){M*l(Math.max(f.left.amount,f.right.amount))}B=k+E,d.$(h).x=.5*n.width-E-(f!=S?.35*k:0),d.$(h).y=.5*n.height,new vis4.DelayedTask(1500,vis4,vis4.log,h,y.pos),E+=.1*n.width,N=g(f.parent),d.$(N).rad=E,d.$(m).rad=E;var R=0-(f!=S?S.centerAngle+m.childRotation:0);for(r in f.children)w=f.children[r],e=b(w),d.$(e).angle=n.shortestAngleTo(e.angle,w.centerAngle+m.childRotation+R),d.$(e).rad=k;var L=.07*n.height;f.left&&(x=f.left,T=l(x.amount)*M,C=p-Math.asin((.5*n.paper.height+T-L)/E),e=b(x),d.$(e).rad=E,d.$(e).angle=O(e.angle,C)),f.right&&(x=f.right,T=l(x.amount)*M,C=Math.asin((.5*n.paper.height+T-L)/E),e=b(x),d.$(e).rad=E,d.$(e).angle=O(e.angle,C)),f=S}for(r in n.displayObjects){var j=n.displayObjects[r];j.hideFlag&&j.visible?(d.$(j).alpha=0,"bubble"==j.className&&j.node.level>1&&(d.$(j).rad=0),d.hide(j)):j.hideFlag||(d.$(j).alpha=1,j.visible||(j.alpha=0,d.show(j)))}i=new a.Transitioner($.browser.msie||n.currentCenter==f?0:560),i.changeLayout(d),n.currentTransition=i,!n.currentCenter&&$.isFunction(n.config.firstNodeCallback)&&n.config.firstNodeCallback(f),n.currentCenter=f}else o.log("node "+t+" not found")},r.unifyAngle=function(t){for(var e=Math.PI,i=2*e;t>=i;)t-=i;for(;t<0;)t+=i;return t},r.shortestAngle=function(t,e){var i=Math.PI,n=2*i,s=r.unifyAngle;t=s(t),e=s(e);var a=e-t;return a>i&&(a-=n),a<-i&&(a+=n),a},r.shortestAngleTo=function(t,e){return t+r.shortestAngle(t,e)},r.shortestLeftTurn=function(t,e){var i=r.shortestAngle(t,e);return i>0&&(i-=2*Math.PI),t+i},r.shortestRightTurn=function(t,e){var i=r.shortestAngle(t,e);return i<0&&(i=2*Math.PI+i),t+i},r.getBubble=function(t,e){return this.getDisplayObject("bubble",t,e)},r.getRing=function(t){return this.getDisplayObject("ring",t)},r.getDisplayObject=function(t,e,i){var r,n,s=this;for(r in s.displayObjects)if(n=s.displayObjects[r],n.className==t&&n.node==e)return i||(n.hideFlag=!1),n;vis4.log(t+" not found for node",e)},r.initHistory=function(){$.history.init(r.urlChanged.bind(r),{unescape:",/"})},r.freshUrl="",r.urlChanged=function(t){var e=this,i=e.currentTransition;e.freshUrl||t.indexOf("/~/")&&(e.baseUrl=t.substr(0,t.indexOf("/~/"))),e.freshUrl=t,i&&i.running?(vis4.log("transition is running at the moment, adding listener"),i.onComplete(e.changeUrl.bind(e))):e.changeUrl()},r.changeUrl=function(){var t,e=this,i=e.freshUrl.split("/"),r=i[i.length-1];""===e.freshUrl&&e.navigateTo(e.treeRoot),e.nodesByUrlToken.hasOwnProperty(r)?(t=e.getUrlForNode(e.nodesByUrlToken[r]),e.freshUrl!=t?$.history.load(t):e.navigateTo(e.nodesByUrlToken[r],!0)):e.navigateTo(e.treeRoot)},r.navigateTo=function(t,e){var i=this;"function"==typeof i.config.navigateTo&&(console.log(e),i.config.navigateTo(t));var r=i.getUrlForNode(t);e?i.changeView(t.urlToken):$.history.load(r),$(".label, .label2").removeClass("current"),$(".label2."+t.id).addClass("current"),$(".label."+t.id).addClass("current")},r.getUrlForNode=function(t){var e=[];for(e.push(t.urlToken);t.parent;)e.push(t.parent.urlToken),t=t.parent;return e.reverse(),r.baseUrl+"/~/"+e.join("/")},r.onNodeClick=function(t){},r.clean=function(){$(".label").remove()},this.loop=function(){TWEEN.update()},!r.config.hasOwnProperty("data"))throw new Error("no data");"string"==typeof r.config.data?r.loadData():new vis4.DelayedTask(1e3,r,r.setData,r.config.data)};BubbleTree.Styles={},BubbleTree.Layout=function(){var t=this;t.objects=[],t.props=[],t.toHide=[],t.toShow=[],t.$=function(t){var e,i,r,n=this;for(e in n.objects)if(i=n.objects[e],i==t)return n.props[e];return n.objects.push(t),r={},n.props.push(r),r},t.show=function(t){var e=this;e.toShow.push(t)},t.hide=function(t){var e=this;e.toHide.push(t)}},BubbleTree.Line=function(t,e,i,r,n,s){this.bc=t,this.o=i,this.angle=r,this.fromRad=n,this.attr=e,this.toRad=s,this.getXY=function(){this.x1=this.o.x+Math.cos(this.angle)*this.fromRad,this.y1=this.o.y-Math.sin(this.angle)*this.fromRad,this.x2=this.o.x+Math.cos(this.angle)*this.toRad,this.y2=this.o.y-Math.sin(this.angle)*this.toRad},this.init=function(){this.getXY(),console.log("foo","M"+this.x1+" "+this.y1+"L"+this.x2+" "+this.y2,e),this.path=this.bc.paper.path("M"+this.x1+" "+this.y1+"L"+this.x2+" "+this.y2).attr(this.attr)},this.draw=function(){this.getXY(),this.path.attr({path:"M"+this.x1+" "+this.y1+"L"+this.x2+" "+this.y2})},this.init()},BubbleTree.Loader=function(t){var e=this;e.config=t,e.ns=BubbleTree,e.loadData=function(){var t=this,e=t.config.data;console.log("loading url ",e),$.ajax({url:e,context:t,dataType:"json",success:function(t){this.run(t)}})},e.run=function(t){var e=this,i=new BubbleTree(e.config);i.setData(t),e.config.instance=i},!e.config.hasOwnProperty("data"),"string"==typeof e.config.data?e.loadData():e.run(e.config.data)},BubbleTree.MouseEventGroup=function(t,e){var i=this;i.target=t,i.members=e,i.click=function(t){var e,i,r=this,n=r.members;r.clickCallback=t;for(e in n)i=n[e],$(i).click(r.handleClick.bind(r))},i.handleClick=function(t){var e=this;e.clickCallback({target:e.target,origEvent:t,mouseEventGroup:e})},i.hover=function(t){var e,i,r=this,n=r.members;r.hoverCallback=t;for(e in n)i=n[e],$(i).hover(r.handleMemberHover.bind(r),r.handleMemberUnHover.bind(r))},i.unhover=function(t){var e=this;e.unhoverCallback=t},i.wasHovering=!1,i.mouseIsOver=!1,i.handleMemberHover=function(t){var e=this;new vis4.DelayedTask(25,e,e.handleMemberHoverDelayed,t)},i.handleMemberHoverDelayed=function(t){var e=this;e.mouseIsOver=!0,e.wasHovering||(e.wasHovering=!0,$.isFunction(e.hoverCallback)&&e.hoverCallback({target:e.target,origEvent:t,mouseEventGroup:e}))},i.handleMemberUnHover=function(t){var e=this;e.mouseIsOver=!1,new vis4.DelayedTask(40,e,e.handleMemberUnHoverDelayed,t)},i.handleMemberUnHoverDelayed=function(t){var e=this;e.mouseIsOver||(e.wasHovering=!1,$.isFunction(e.unhoverCallback)&&e.unhoverCallback({target:e.target,origEvent:t,mouseEventGroup:e}))},i.addMember=function(t){var e=this;e.hoverCallback&&$(t).hover(e.handleMemberHover.bind(e),e.handleMemberUnHover.bind(e)),e.members.push(t)},i.removeMember=function(t){var e,i=this,r=i.members,n=[];i.clickCallback&&$(t).unbind("click"),i.hoverCallback&&$(t).unbind("mouseenter mouseleave");for(e in r)r[e]!=t&&n.push(r[e]);i.members=n}},BubbleTree.Ring=function(t,e,i,r,n){var s=this;s.className="ring",s.rad=r,s.bc=e,s.attr=n,s.origin=i,s.alpha=1,s.visible=!1,s.node=t,s.init=function(){},s.draw=function(){var t=this,e=t.origin;t.visible&&t.circle.attr({cx:e.x,cy:e.y,r:t.rad,"stroke-opacity":t.alpha})},s.hide=function(){var t=this;t.circle.remove(),t.visible=!1},s.show=function(){var t=this;t.circle=t.bc.paper.circle(i.x,i.y,t.rad).attr(t.attr),t.visible=!0,t.circle.toBack()},s.init()},BubbleTree.Transitioner=function(t){var e=this;e.duration=t,e.running=!1,e.completeCallbacks=[],e.changeLayout=function(t){var e,i,r,n,s=this;s.running=!0,s.layout=t;for(e in t.toShow)i=t.toShow[e],$.isFunction(i.show)&&i.show();for(e in t.objects)if(i=t.objects[e],void 0!==i&&null!==i)if(r=t.props[e],s.duration>0){var a=new TWEEN.Tween(i),o={};for(n in r)o[n]=r[n];a.to(o,.6*s.duration),a.easing(TWEEN.Easing.Exponential.EaseOut),$.isFunction(i.draw)&&a.onUpdate(i.draw.bind(i)),e==t.objects.length-1&&a.onComplete(s._completed.bind(s)),a.start()}else{for(n in r)i[n]=r[n];i&&$.isFunction(i.draw)&&i.draw()}if(0===s.duration){for(e in t.objects)i=t.objects[e],i&&$.isFunction(i.draw)&&i.draw();s._completed()}},e.onComplete=function(t){var e=this;try{$.isFunction(t)&&e.completeCallbacks.push(t)}catch(t){}},e._completed=function(){var t,e,i=this,r=i.completeCallbacks;i.running=!1;for(t in i.layout.objects)e=i.layout.objects[t],e&&$.isFunction(e.draw)&&e.draw();
for(t in i.layout.toHide)e=i.layout.toHide[t],e&&$.isFunction(e.hide)&&e.hide();for(t in r)r[t]()}},BubbleTree.Utils={},BubbleTree.Utils.log=function(){try{window.hasOwnProperty("console")&&console.log.apply(this,arguments)}catch(t){}},BubbleTree.Utils.amount2rad=function(t){return Math.pow(Math.max(0,t)/BubbleTree.a2radBase,.6)},BubbleTree.Utils.formatNumber=function(t){var e="";return t<0&&(t*=-1,e="-"),t>=1e12?e+Math.round(t/1e11)/10+"t":t>=1e9?e+Math.round(t/1e8)/10+"b":t>=1e6?e+Math.round(t/1e5)/10+"m":t>=1e3?e+Math.round(t/100)/10+"k":e+t},BubbleTree.Vector=function(t,e){var i=this;i.x=t,i.y=e,i.length=function(){var t=this;return Math.sqrt(t.x*t.x+t.y*t.y)},i.normalize=function(t){var e=this,i=e.length();t||(t=1),e.x*=t/i,e.y*=t/i},i.clone=function(){var t=this;return new BubbleTree.Vector(t.x,t.y)}},BubbleTree.Bubbles=BubbleTree.Bubbles||{},BubbleTree.Bubbles=BubbleTree.Bubbles||{},BubbleTree.Bubbles.Donut=function(t,e,i,r,n,s){var a=BubbleTree,o=a.Utils,h=this;h.className="bubble",h.node=t,h.paper=e.paper,h.origin=i,h.bc=e,h.rad=r,h.angle=n,h.color=s,h.alpha=1,h.visible=!1,h.ns=a,h.bubbleRad=o.amount2rad(this.node.amount),h.childRotation=0,h.getXY=function(){var t=this,e=t.origin,i=t.angle,r=t.rad;t.pos.x=e.x+Math.cos(i)*r,t.pos.y=e.y-Math.sin(i)*r},h.init=function(){var t=this;t.pos=new t.ns.Vector(0,0),t.getXY();var e,i,r,n=[],s=[],a=t.bc.config.bubbleStyles;t.node.shortLabel||(t.node.shortLabel=t.node.label.length>50?t.node.label.substr(0,30)+"...":t.node.label),t.breakdownOpacities=[.2,.7,.45,.6,.35],t.breakdownColors=[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1];for(i in t.node.breakdowns)e=t.node.breakdowns[i],e.famount=o.formatNumber(e.amount),r=e.amount/t.node.amount,n.push(r),s.push(e),a&&a.hasOwnProperty("name")&&a.name.hasOwnProperty(e.name)&&a.name[e.name].hasOwnProperty("opacity")&&(t.breakdownOpacities[s.length-1]=a.name[e.name].opacity),a&&a.hasOwnProperty("name")&&a.name.hasOwnProperty(e.name)&&a.name[e.name].hasOwnProperty("color")&&(t.breakdownColors[s.length-1]=a.name[e.name].color,t.breakdownOpacities[s.length-1]=1);t.node.breakdowns=s,t.breakdown=n;t.initialized=!0},h.onclick=function(e){var i=this;"function"==typeof i.bc.config.onClick&&i.bc.config.onClick(t),i.bc.navigateTo(i.node)},h.onhover=function(t){var e=this,i=e.bc.$container[0];t.node=e.node,t.target=e,t.bubblePos={x:e.pos.x,y:e.pos.y},t.mousePos={x:t.origEvent.pageX-i.offsetLeft,y:t.origEvent.pageY-i.offsetTop},t.type="SHOW",e.bc.tooltip(t)},h.onunhover=function(t){var e=this,i=e.bc.$container[0];t.node=e.node,t.target=e,t.type="HIDE",t.bubblePos={x:e.pos.x,y:e.pos.y},t.mousePos={x:t.origEvent.pageX-i.offsetLeft,y:t.origEvent.pageY-i.offsetTop},e.bc.tooltip(t)},this.draw=function(){var t=this,e=Math.max(5,t.bubbleRad*t.bc.bubbleScale),i=(t.pos.x,t.pos.y,t.getXY(),t.pos.x),r=t.pos.y;if(t.visible){t.alpha=0;var n={cx:i,cy:r,r:e,"fill-opacity":t.alpha,class:t.node.id+"-circle"};if(t.circle.attr(n),t.circle.node.setAttribute("class","circle-"+t.node.id),t.node.stroke?(t.dashedBorder.attr({cx:i,cy:r,r:e,"stroke-opacity":1}),t.dashedBorder.node.setAttribute("class",t.node.strokeClass)):t.node.dashed&&(t.dashedBorder.attr({cx:i,cy:r,r:e+3,"stroke-opacity":1,"stroke-dasharray":"- "}),t.dashedBorder.node.setAttribute("class","dashed")),t.breakdown.length>1){var s,a,o,h,l,c,u,f,d,p,b=.85*e,g=.5*-Math.PI;for(s in t.breakdown){p=t.breakdown[s]*Math.PI*2,a=i+Math.cos(g)*b,c=r+Math.sin(g)*b,o=i+Math.cos(g+p)*b,u=r+Math.sin(g+p)*b,h=i+Math.cos(g+p)*e,f=r+Math.sin(g+p)*e,l=i+Math.cos(g)*e,d=r+Math.sin(g)*e,g+=p;var v="M"+a+" "+c+" A"+b+","+b+" 0 "+(p>Math.PI?"1,1":"0,1")+" "+o+","+u+" L"+h+" "+f+" A"+e+","+e+" 0 "+(p>Math.PI?"1,0":"0,0")+" "+l+" "+d+" Z";t.breakdownArcs[s].attr({path:v,"stroke-opacity":.2*t.alpha,"fill-opacity":t.breakdownOpacities[s]*t.alpha})}}t.label.show(),t.label.css({width:2*e+"px",height:2*e+"px",opacity:1}),t.label.css({left:t.pos.x-e+"px",top:t.pos.y-e+"px"})}},this.hide=function(){var t,e=this;e.circle.remove(),e.dashedBorder.remove(),e.label.remove(),e.label2.remove(),e.visible=!1;for(t in e.breakdownArcs)e.breakdownArcs[t].remove()},h.show=function(){var e,i=this,r=Math.max(5,i.bubbleRad*i.bc.bubbleScale),n={stroke:!1};i.icon?n["fill-opacity"]=0:n.fill=i.color,i.circle=i.paper.circle(i.pos.x,i.pos.y,r).attr(n),$.isFunction(i.bc.config.initTooltip)&&i.bc.config.initTooltip(i.node,i.circle.node),i.dashedBorder=i.paper.circle(i.pos.x,i.pos.y,1.05*r).attr({stroke:i.node.stroke,"stroke-opacity":1,fill:!1,class:"dashed"});var s='<div class="desc">'+i.node.shortLabel+"</div>";if(i.node.icon&&(s+='<div class="icon-container"><img class="smooth node-img-'+i.node.id+'" src="'+i.node.icon+'"></div>'),i.node.images&&i.node.images.length){s+='<div class="images">';for(var e=0;e<i.node.images.length;e++){var a=t.images[e];s+='<img src="'+a+'" alt="profile">'}s+="</div>"}var o,h=i.node.icon?"transparent":i.color;i.node.detail&&!i.node.icon&&(o='<div class="card label '+i.node.id+'" > <div class="front" style="background: '+h+';">'+i.node.shortLabel+'</div> <div class="back" style="background: white; color: black;">'+i.node.detailContent+"</div> </div>");var l=o?o:'<div class="label '+i.node.id+(i.node.icon?" iconized ":"")+'" style="background:'+h+'">'+s+"</div>";i.label=$(l),i.node.detail&&!i.node.icon&&(i.label.flip({trigger:"manual"}),i.label.on("click",function(t){i.label.hasClass("current")&&$("."+i.node.id).flip("toggle")})),i.node.clazz&&i.label.addClass(i.node.clazz),i.bc.$container.append(i.label);var c=i.node;l=$(".label."+c.id),i.node.droppable&&i.enableDrop(c),c.timeProgress&&c.timeProgress<1&&(c.timeProgressBar&&c.timeProgressBar.destroy(),l.length&&(c.timeProgressBar=factory.build(l.get(0),"#009ddc","easeIn",c.timeProgress))),i.node.children.length>1&&($(i.circle.node).css({cursor:"pointer"}),$(i.label).css({cursor:"pointer"})),i.label2=$('<div class="label2 '+i.node.id+'"><span>'+i.node.shortLabel+"</span></div>"),i.bc.$container.append(i.label2);var u=[i.circle.node,i.label];if(i.breakdown.length>1){i.breakdownArcs={};for(e in i.breakdown){var f=i.breakdownColors[e]?i.breakdownColors[e]:"#fff",d=i.paper.path("M 0 0 L 2 2").attr({fill:f,"fill-opacity":.4*Math.random()+.3,stroke:"#fff"});i.breakdownArcs[e]=d,$.isFunction(i.bc.config.initTooltip)&&i.bc.config.initTooltip(i.node.breakdowns[e],d.node)}for(e in i.breakdownArcs)$(i.breakdownArcs[e].node).click(i.onclick.bind(i))}var p=new i.ns.MouseEventGroup(i,u);p.click(i.onclick.bind(i)),p.hover(i.onhover.bind(i)),p.unhover(i.onunhover.bind(i)),i.visible=!0},h.enableDrop=function(t){console.log("Enabling drop");var e=$(".label."+t.id),i=this;e.attr("drop","true"),e.addClass("droppable"),e.off("dragover"),e.off("dragleave"),e.off("dropover"),e.off("drop"),e.droppable({over:function(t,i){e.addClass("dragover")},out:function(t,i){e.removeClass("dragover")}}),e.on("dragover",function(t){t.stopPropagation(),t.preventDefault(),e.addClass("dragover")}),e.on("dragleave",function(t,i,r){t.stopPropagation(),t.preventDefault(),console.log("Dragging leave"),e.removeClass("dragover")}),e.on("drop",function(r,n,s){r.stopPropagation(),r.preventDefault(),e.removeClass("dragover"),i.bc.config.handleDrop(r,t)})},h.arcHover=function(t){var e,i=this,r=i.bc.$container[0],n=i.breakdownArcs,s=i.node.breakdowns;for(e in n)if(n[e].node==t.target)return t.node=s[e],t.bubblePos={x:i.pos.x,y:i.pos.y},t.mousePos={x:t.pageX-r.offsetLeft,y:t.pageY-r.offsetTop},t.target=i,t.type="SHOW",void i.bc.tooltip(t);vis4.log("cant find the breakdown node")},h.arcUnhover=function(t){var e,i=this,r=i.bc.$container[0],n=i.breakdownArcs,s=i.node.breakdowns;for(e in n)if(n[e].node==t.target)return t.node=s[e],t.bubblePos={x:i.pos.x,y:i.pos.y},t.mousePos={x:t.pageX-r.offsetLeft,y:t.pageY-r.offsetTop},t.type="HIDE",t.target=i,void i.bc.tooltip(t);vis4.log("cant find the breakdown node")},h.init()},BubbleTree.Bubbles=BubbleTree.Bubbles||{};